---
title: 'Trait Sexual Desire-Linked Subjective Sexual Arousal to Erotic and Non-Erotic Stimuli: Gender, Relationship Status, and Gender-Specificity'
subtitle: Code and analyses
author:
  - name: Milena Vásquez-Amézquita \orcidlink{0000-0001-7317-8430}
    correspondence: true
    institute: [costa, ueb, gcul, codec]
    email: mvasquezam@unbosque.edu.co
  - name: Juan David Leongómez \orcidlink{0000-0002-0092-6298}
    correspondence: false
    institute: [ueb, codec]
  - name: Marina Begoña Martínez-González \orcidlink{0000-0002-5840-6383}
    correspondence: false
    institute: costa
  - name: Meredith L. Chivers \orcidlink{0000-0002-5495-9263}
    correspondence: false
    institute: queen
institute:
  - costa: 'Departamento de Ciencias Sociales, Universidad de la Costa, Barranquilla 080002, Colombia.'
  - ueb: 'Facultad de Psicología, Universidad El Bosque, Bogotá 110121, Colombia.'
  - gcul: 'Grupo de Investigación en Cultura, Educación y Sociedad, Universidad de la Costa, Barranquilla 080002, Colombia.'
  - codec: 'CODEC: Ciencias Cognitivas y del Comportamiento, Universidad El Bosque, Bogotá 110121, Colombia.'
  - queen: 'Department of Psychology, Queen’s University, Kingston ON K7L 3N6, Canada.'
date: "`r Sys.setlocale('LC_TIME','en_US.UTF-8');format(Sys.Date(),'%d %B, %Y')`"
output:
  bookdown::pdf_document2:
    citation_package: biblatex
    highlight: zenburn
    number_sections: yes
    keep_tex:  true
    toc: no
    pandoc_args:
      - '--lua-filter=lua/scholarly-metadata.lua'
      - '--lua-filter=lua/author-info-blocks.lua'
classoption: 
      - bookmarksnumbered
editor_options:
  chunk_output_type: console
geometry: margin=2cm
header-includes: 
  \usepackage{caption} 
  \usepackage{float} 
  \floatplacement{figure}{H} 
  \usepackage[utf8]{inputenc} 
  \usepackage{fancyhdr}
  \pagestyle{fancy} 
  \usepackage{hanging}
  \lhead{Vásquez-Amézquita et al.} 
  \rhead{\textit{Desire and sexual arousal}} 
  \renewcommand{\abstractname}{Description} 
  \usepackage[british]{babel}
  \usepackage{csquotes}
  \usepackage[style=apa,backend=biber]{biblatex}
  \DeclareLanguageMapping{british}{british-apa}
  \usepackage{hanging}
  \usepackage{amsthm,amssymb,amsfonts}
  \usepackage{tikz,lipsum,lmodern}
  \usepackage{multicol}
  \usepackage{orcidlink}
  \newcommand{\opensupplement}{\setcounter{table}{0}
    \renewcommand{\thetable}{S\arabic{table}} \setcounter{figure}{0}
    \renewcommand{\thefigure}{S\arabic{figure}}}
  \newcommand{\closesupplement}{\setcounter{table}{0}
    \renewcommand{\thetable}{\arabic{table}} \setcounter{figure}{0}
    \renewcommand{\thefigure}{\arabic{figure}}}
  \usepackage{multirow,booktabs,setspace}
  \DeclareCaptionLabelSeparator{point}{. }
  \DeclareCaptionLabelSeparator{point}{. }
  \captionsetup[table]{labelfont=bf,
    textfont=it,
    format=plain,
    labelsep=point,
    skip=5pt}
  \captionsetup[figure]{labelfont=bf,
    format=plain,
    justification=justified,
    singlelinecheck=false,
    labelsep=point,
    skip=5pt}
always_allow_html: yes
bibliography: bib/Bibliography.bib
urlcolor: blue
linkcolor: gray
citecolor: gray
link-citations: true
---

------------------------------------------------------------------------

```{=tex}
\begin{center}
\textbf{Description}
\end{center}

\par
\begingroup
\leftskip3em
\rightskip\leftskip
```

This document contains all code, and step by step explanations for all analyses, figures and tables (including supplementary figures and tables) for:

```{=latex}
\begin{hangparas}{.25in}{1}
Vásquez-Amézquita, M., Leongómez, J. D., Martínez-González, M. B., \& Chivers, M. L. (in prep). \textit{Trait Sexual Desire-Linked Subjective Sexual Arousal to Erotic and Non-Erotic Stimuli: Gender, Relationship Status, and Gender-Specificity}
\end{hangparas}
```

Data available from the Open Science Framework (OSF): <https://doi.org/10.17605/OSF.IO/3V2E7>. All analyses were planned by Milena Vásquez-Amézquita and Juan David Leongómez. This document and its underlying code were created in `R Markdown` by Juan David Leongómez using \LaTeX.

------------------------------------------------------------------------

```{=latex}
\par
\endgroup

{\hypersetup{hidelinks}
\setcounter{tocdepth}{6}
\tableofcontents
}
\opensupplement
```

```{r results = "hold", setup, include = FALSE}
library(knitr)
opts_chunk$set(fig.width = 12, fig.height = 6, fig.pos = "H")
options(knitr.kable.NA = " ")
opts_knit$set(eval.after = "fig.cap")
```

------------------------------------------------------------------------
 
# Preliminaries

## Load packages

This file was created using `knitr` [@knitrcit], mostly using `tidyverse` [@tidyversecit] syntax. As such, data wrangling was mainly done using packages such as `dplyr` [@dplyrcit], and most figures were created or modified using `ggplot2` [@ggplotcit]. Tables were created using `knitr::kable` and `kableExtra` [@kableExtracit].

Linear mixed models were fitted using `lmerTest` [@lmertestcit], assumptions were performed using `performance` [@ludecke2021], contrasts and interactions were explored using `emmeans` [@emmeanscit], and interactions were investigated using the package `interactions` [@interactionscit].

All packages used in this file can be directly installed from the Comprehensive R Archive Network ([CRAN](https://cran.r-project.org/)). For a complete list of packages used to create this file, and their versions, see section \@ref(session), at the end of the document.

```{r message = FALSE}
# Load required libraries for data import, modeling, visualization, and statistical analysis
# Suppress messages during loading for a cleaner output
library(readxl)        # Read Excel files (.xls and .xlsx)
library(lme4)          # Fit linear and generalized linear mixed-effects models
library(ordinal)       # Analyze ordinal response data with cumulative link models
library(lmerTest)      # Enhances lme4 by adding p-values for mixed-effects models
library(ltm)           # Latent trait models, useful for item response theory (IRT)
library(car)           # Companion to Applied Regression, includes various statistical tests
library(tidyquant)     # Extends the tidyverse for quantitative financial analysis
library(performance)   # Assesses model fit, assumptions, and performance diagnostics
library(kableExtra)    # Enhances `kable()` for creating stylish tables in reports
library(psych)         # Tools for psychological and psychometric analysis
library(scales)        # Scaling functions for visualization (e.g., rescaling axes)
library(emmeans)       # Estimated marginal means (EMMs) for contrasts and post-hoc comparisons
library(berryFunctions) # Various utility functions (e.g., data manipulation, visualization)
library(bestNormalize) # Implements normalization techniques for data transformation
library(rstatix)       # Streamlines statistical tests and effect size calculations
library(effectsize)    # Computes effect sizes, confidence intervals, and standardized measures
library(ggpubr)        # Publication-ready figures, extends `ggplot2` 
library(interactions)  # Facilitates interaction plots and effect visualization
library(tidyverse)     # Data manipulation and visualization packages (e.g., dplyr, ggplot2)
```

## Define color palettes

Individual color palettes for figures by gender, stimuli sex, or relationship type.

```{r}
# Palette to color figures by gender
color.Gender <- c("red", "black")
# Palette to color figures by stimuli sex
color.StimuliSex <- c("#54278F", "#FC4E2A")
# Palette to color figures by relationship type
color.Relationship <- c("#2171B5", "#DD3497")
# Palette to color figures by stimuli content
color.Content <- c("#41AB5D", "navyblue") 
```

## Custom functions

### `pval.lev`,  `pe2.lev` and `pval.stars`

This functions take p-values and epsilon squared effect sizes and formats them in \LaTeX, highlighting significant p-values in bold and representing all in an appropriate level.

```{r}
# Function to format p-values for LaTeX output, highlighting significant values in bold
pval.lev <- function(pvals) {
  ifelse(pvals < 0.0001, "\\textbf{< 0.0001}",  # Highlight very small p-values
    ifelse(pvals < 0.001, "\\textbf{< 0.001}",  # Bold p-values < 0.001
      ifelse(pvals < 0.05, paste0("\\textbf{", round(pvals, 4), "}"),  # Bold p-values < 0.05
        round(pvals, 2)  # Round non-significant values to two decimal places
      )
    )
  )
}

# Function to format partial epsilon squared (pe2) values for reporting
pe2.lev <- function(pvals) {
  ifelse(pvals < 0.0001, "< 0.0001",  # Represent very small values as "< 0.0001"
    ifelse(pvals < 0.001, "< 0.001",  # Represent values < 0.001 in scientific format
      ifelse(pvals < 0.05, round(pvals, 4),  # Round values < 0.05 to four decimal places
        round(pvals, 2)  # Round all other values to two decimal places
      )
    )
  )
}

# Function to add significance stars based on p-value thresholds
pval.stars <- function(pvals) {
  ifelse(pvals < 0.0001, "****",  # Four stars for p < 0.0001
    ifelse(pvals < 0.001, "***",  # Three stars for p < 0.001
      ifelse(pvals < 0.01, "**",  # Two stars for p < 0.01
        ifelse(pvals < 0.05, "*", NA)  # One star for p < 0.05, NA otherwise
      )
    )
  )
}
```

### `corr.stars`

This function creates a correlation matrix, and displays significance (function `corr.stars` modified from <http://myowelt.blogspot.com/2008/04/beautiful-correlation-tables-in-r.html>).

```{r}
# Function to create a correlation matrix with significance levels in LaTeX format
corr.stars <- function(x) {
  require(Hmisc)  # Load Hmisc package for correlation and p-value calculations
  x <- as.matrix(x)  # Ensure input is a matrix
  R <- rcorr(x)$r    # Compute correlation coefficients
  p <- rcorr(x)$P    # Extract p-values for significance testing
  # Define symbols for significance levels, using LaTeX formatting for bold and stars
  mystars <- ifelse(p < .001, paste0("\\textbf{", round(R, 2), "***}"),  # p < 0.001
    ifelse(p < .01, paste0("\\textbf{", round(R, 2), "**}"),  # p < 0.01
      ifelse(p < .05, paste0("\\textbf{", round(R, 2), "*}"),  # p < 0.05
        ifelse(p < .10, paste0(round(R, 2), "$^{\\dagger}$"),  # p < 0.10 (trend level)
          format(round(R, 2), nsmall = 2)  # Format non-significant values with two decimals
        )
      )
    )
  )
  # Construct a new matrix with correlation values and significance symbols
  Rnew <- matrix(mystars, ncol = ncol(x))
  # Ensure diagonal values remain the original correlation values (without significance symbols)
  diag(Rnew) <- paste(diag(R), " ", sep = "")
  # Assign row and column names for the formatted matrix
  rownames(Rnew) <- colnames(x)
  colnames(Rnew) <- paste(colnames(x), "", sep = "")
  # Remove the upper triangle of the matrix (including the diagonal) for a clean presentation
  Rnew <- as.matrix(Rnew)
  Rnew[upper.tri(Rnew, diag = TRUE)] <- ""
  # Convert to a data frame for better handling and remove the last empty column
  Rnew <- as.data.frame(Rnew)
  Rnew <- cbind(Rnew[1:length(Rnew) - 1])
  return(Rnew)  # Return formatted correlation table
}
```

### `anova.sig.lm` and `anova.sig.lmer`

Functions to bold significant *p* values from `anova` or `car:Anova` model tables. It highlights significant $p$ values, and formats the output in \LaTeX, ready to be used with `kable`.

```{r results = "hold"}
# Function to format ANOVA results for linear models (lm) in LaTeX format
anova.sig.lm <- function(model, custom_caption) {
  aovTab <- bind_cols(
    anova_summary(Anova(model, type = 3)),  # Perform Type III ANOVA
    epsilon_squared(model)  # Compute partial epsilon squared effect sizes
  ) |>
    unite(col = "df", DFn:DFd, sep = ", ") |>  # Combine numerator and denominator df
    select(Effect, df, F, p, Epsilon2_partial) |>  # Select relevant columns
    mutate(
      p = pval.lev(p),  # Format p-values in LaTeX, bolding significant ones
      Epsilon2_partial = pe2.lev(Epsilon2_partial)  # Format epsilon squared values
    ) |>
    mutate_at("Effect", str_replace_all, ":", " × ") |>  # Replace ":" with "×" for LaTeX
    kable(
      digits = 2, booktabs = TRUE, align = c("l", rep("c", 4)), linesep = "",
      caption = custom_caption,
      col.names = c("Effect", "$df$", "$F$", "$p$", "$\\epsilon^2_p$"),
      escape = FALSE
    ) |>
    kable_styling(latex_options = c("HOLD_position", "scale_down")) |>
    footnote(
      general = paste0(
        "Sexual desire was transformed using an ordered quantile normalization ",
        "(\\\\cite{petersonOrderedQuantileNormalization2020a}). ",
        "Results are Type III ANOVA. ",
        "$R^2$ = ", round(r2(model)$R2, 3),
        ", $R^2_{adjusted}$ = ", round(r2(model)$R2_adjusted, 3), ". ",
        "Gender = participant's gender (women, men); ",
        "Relationship = relationship type (stable, single). ",
        "As effect size, we report partial epsilon squared ",
        "($\\\\epsilon^2_p$), a less biased estimate than $\\\\eta^2$ ",
        "(see \\\\cite{albersWhenPowerAnalyses2018}). ",
        "Significant effects are in bold."
      ),
      escape = FALSE, threeparttable = TRUE, footnote_as_chunk = TRUE
    )
  return(aovTab)
}

# Function to format ANOVA results for linear mixed models (lmer) in LaTeX format
anova.sig.lmer <- function(model, custom_caption) {
  aovTab <- bind_cols(
    anova(model),  # Perform ANOVA on the mixed-effects model
    epsilon_squared(model)  # Compute partial epsilon squared effect sizes
  ) |>
    mutate(DenDF = round(DenDF, 2)) |>  # Round denominator degrees of freedom
    unite(col = "df", NumDF:DenDF, sep = ", ") |>  # Combine numerator & denominator df
    rownames_to_column(var = "Effect") |>  # Convert row names to a column
    rename(
      "F" = "F value",  # Rename columns for consistency
      "p" = "Pr(>F)"
    ) |>
    select(Effect, df, F, p, Epsilon2_partial) |>  # Select relevant columns
    mutate(
      p = pval.lev(p),  # Format p-values in LaTeX, bolding significant ones
      Epsilon2_partial = pe2.lev(Epsilon2_partial)  # Format epsilon squared values
    ) |>
    mutate(Effect = str_replace_all(Effect, "\\.", " ")) |>  # Replace dots with spaces
    mutate(Effect = str_replace_all(Effect, ":", " × ")) |>  # Replace ":" with "×" for LaTeX
    kable(
      digits = 2, booktabs = TRUE, align = c("l", rep("c", 4)), linesep = "",
      caption = custom_caption,
      col.names = c("Effect", "$df$", "$F$", "$p$", "$\\epsilon^2_p$"),
      escape = FALSE
    ) |>
    kable_styling(latex_options = c("HOLD_position", "scale_down")) |>
    footnote(
      general = paste0(
        "Results are Type III ANOVA. ",
        "$R^2_{conditional}$ = ", round(r2_nakagawa(model)$R2_conditional, 3),
        ", $R^2_{marginal}$ = ", round(r2_nakagawa(model)$R2_marginal, 3), ". ",
        "As effect size, we report partial epsilon squared ",
        "($\\\\epsilon^2_p$), a less biased estimate than $\\\\eta^2$ ",
        "(see \\\\cite{albersWhenPowerAnalyses2018}). ",
        "Significant effects are in bold."
      ),
      escape = FALSE, threeparttable = TRUE, footnote_as_chunk = TRUE
    )
  return(aovTab)
}
```

### `anova.comp`

Function to compare ANOVA-type tables from hypotheses 2 and 3 models fitted with different techniques:  `ordinal::clmm` (Cumulative Link Mixed Models, CLMM), `lme4::glmer` (Generalized Linear Mixed-Effects Models; GLMER) and `lmerTest::lmer` (Linear Mixed-Effects Models, LMER). The function bold significant *p* values from `anova` or `car:Anova` tables. It highlights significant $p$ values, and formats the output in \LaTeX, ready to be used with `kable`.

```{r}
# Function to compare ANOVA results across CLMM, GLMER (Poisson), and LMM models
anova.comp <- function(CLMMmod, GLMERmod, LMERmod, hypothesis) {
  compTab <- 
    reduce(
      list(
        # ANOVA results for the Cumulative Link Mixed Model (CLMM)
        Anova(CLMMmod, type = 3) |> 
          as.data.frame() |> 
          mutate(`Pr(>Chisq)` = pval.lev(`Pr(>Chisq)`)) |>  # Format p-values
          rownames_to_column("Effect"),
        # ANOVA results for the Generalized Linear Mixed Model (GLMM, Poisson),
        # selecting relevant columns & removing the intercept row
        Anova(GLMERmod, type = 3) |> 
          as.data.frame() |> 
          mutate(`Pr(>Chisq)` = pval.lev(`Pr(>Chisq)`)) |>  # Format p-values
          rownames_to_column("Effect") |> 
          select(Effect, Df, Chisq, `Pr(>Chisq)`) |>  # Keep relevant columns
          slice_tail(n = -1),  # Remove intercept row
        # ANOVA results for the Linear Mixed Model (LMM),
        # rounding denominator DF and formatting df column
        anova(LMERmod, type = 3) |> 
          as.data.frame() |> 
          rownames_to_column("Effect") |> 
          mutate(
            DenDF = round(DenDF, 2),  # Round denominator df
            `Pr(>F)` = pval.lev(`Pr(>F)`)  # Format p-values
          ) |> 
          unite(col = "df", NumDF:DenDF, sep = ", ") |>  # Combine numerator & denominator df
          select(Effect, df, `F value`, `Pr(>F)`)  # Keep relevant columns
      ),
      full_join, by = "Effect"  # Merge tables by "Effect"
    ) |> 
    # Improve readability of effect names
    mutate(Effect = str_replace_all(Effect, "\\.", " ")) |>  # Replace dots with spaces
    mutate(Effect = str_replace_all(Effect, ":", " × ")) |>  # Replace colons with × for LaTeX
    # Generate formatted table
    kable(
      booktabs = TRUE, align = c("l", rep("c", 9)), digits = 3, linesep = "",
      caption = paste0(
        "Comparison of fixed effects across the three models for Hypothesis ", 
        hypothesis, ": CLMM, GLMM (Poisson), and LMM."
      ),
      col.names = c(
        "Effect", rep(c("$df$", "$\\chi^2$", "$p$"), times = 2), "$df$", "$F$", "$p$"
      ),
      escape = FALSE
    ) |> 
    # Apply LaTeX styling
    kable_styling(latex_options = c("HOLD_position", "scale_down")) |> 
    # Add section headers for each model
    add_header_above(c(
      " " = 1, "CLMM" = 3, "GLMER (Poisson)" = 3, "LMM" = 3
    )) |> 
    # Add footnote explaining statistical details
    footnote(
      general = "For CLMM and GLMER (Poisson) models, results are
              Analysis of Deviance (Type III Wald chi-square tests),
              while for LMM, results are from an Analysis of Variance
              (Type III ANOVA with Satterthwaite's method).
              Significant effects are in bold.",
      threeparttable = TRUE, footnote_as_chunk = TRUE, escape = FALSE
    )
  return(compTab)  # Return the formatted comparison table
}
```

### `contr.stars`

Function to create a data frame of model contrasts, representing significance levels from an `emmeans::emmeans` output. These data frames are formatted to be called by the `ggpubr::stat_pvalue_manual` function used in model figures.

```{r results = "hold"}
# Function to format contrast results from emmeans for ggpubr::stat_pvalue_manual
contr.stars <- function(emms) {
  require(emmeans)  # Load emmeans package for pairwise comparisons
  # Compute pairwise contrasts and convert output to a data frame
  x <- as.data.frame(contrast(emms, interaction = "pairwise"))
  # Separate the first column into two groups (group1 and group2)
  x <- separate(
    x, col = 1, into = c("group1", "group2"), sep = " - ", remove = TRUE
  )
  # Assign significance stars based on p-value thresholds
  x$p.signif <- ifelse(x$p.value < 0.0001, "****",  # p < 0.0001
    ifelse(x$p.value < 0.001, "***",  # p < 0.001
      ifelse(x$p.value < 0.01, "**",  # p < 0.01
        ifelse(x$p.value < 0.05, "*", NA)  # p < 0.05, otherwise NA
      )
    )
  )
  # Remove parentheses from group names for cleaner labeling
  x <- x |> 
    mutate_at("group1", str_replace_all, "[()]", "") |> 
    mutate_at("group2", str_replace_all, "[()]", "")
  return(x)  # Return formatted contrast data frame
}
```

## Load and wrangle data

Change necessary variables to factor, sort levels, and rename variables

```{r message = FALSE}
# Load data
dat <- read.csv("Data/BD_Heterosexuales_Vertical_BIG.csv") |>
  # Remove rows with missing values for Solitary sexual desire (SD_solitario)
  drop_na(SD_solitario) |>
  # Change variables to factor and sort their levels
  mutate_at(c(
    "Contenido_Estimulo", "Sexo", "Sexo_Estimulo", "PrefSex", "EstRel", "Escolaridad",
    "Religion", "TiempoRP"
  ), as.factor) |>
  # Rename variables to English
  rename(
    Participant = Participante,
    Age = EdadParticipante,
    `Preferred sex` = PrefSex,
    Gender = Sexo,
    `Contraceptive uso` = Anticoncep,
    `Last period` = UltimoPer,
    `Period day` = Dia_ciclo,
    Education = Escolaridad,
    Location = Residencia,
    `Location (other)` = Residencia_3_TEXT,
    `Medical history` = AntMed,
    `Sexual orientation` = OS,
    `Relationship status` = EstRel,
    `Relationship duration` = TiempoRP,
    `Partner gender` = SexPareja,
    `Relationship type` = TipoRel,
    `Age at first intercourse` = Primera.ExpSex,
    `Consented to first intercourse` = ConExpSex,
    `Number of sexual partners` = Numero.Parejas,
    `Pornography consumed last month` = Pornografia_ultimo_mes,
    Relationship = TieneRelacion,
    `MGH-SFQ (total)` = MGH.SFQ_Total,
    `Dyadic sexual desire (Partner)` = SD_Diadico_pareja,
    `Solitary sexual desire` = SD_solitario,
    `Dyadic sexual desire (Attractive person)` = SD_Diadico_p_atractiva,
    `MGSS sexual satisfaction (General)` = Satisfaccion.Sexual..MGSS_general.,
    `MGSS sexual satisfaction (Partner)` = Satisfaccion.Sexual..MGSS_Pareja.,
    `Stimuli code` = Codigo_Estimulo,
    `Stimuli sex` = Sexo_Estimulo,
    `Stimuli content` = Contenido_Estimulo,
    `Subjective sexual attractiveness` = Atractivo,
    `Subjective sexual arousal` = Excitacion
  ) |>
  # Recode factor levels
  mutate(`Stimuli content` = recode_factor(`Stimuli content`,
    Erotico = "Erotic",
    No_erotico = "Non-erotic"
  )) |>
  mutate(Gender = recode_factor(Gender,
    Femenino = "Women",
    Masculino = "Men"
  )) |>
  mutate(`Stimuli sex` = recode_factor(`Stimuli sex`,
    Femenino = "Female",
    Masculino = "Male"
  )) |>
  mutate(`Preferred sex` = recode_factor(`Preferred sex`,
    Hombre = "Male",
    Mujer = "Female"
  )) |>
  mutate(Education = recode(Education,
    "Bachillerato" = "High school",
    "Universitario" = "University",
    "Postgrado" = "Postgraduate"
  )) |>
  mutate(Religion = recode(Religion,
    "1" = "Religious",
    "0" = "Non-religious"
  )) |>
  mutate(`Pornography consumed last month` = recode(`Pornography consumed last month`,
    "Nunca" = "None",
    "Una o dos veces" = "1-2 times",
    "Tres a cinco veces" = "3-5 times",
    "Mas de 5 veces" = "5 times or more"
  )) |>
  # Recode relationship duration
  # mutate(`Relationship duration` = replace_na(`Relationship duration`, "Single"))
  mutate(
    `Relationship duration` = recode(`Relationship duration`,
      "Sin pareja actual" = "Single",
      "Menor a 6 meses" = "Less that 6 months",
      "Entre 6 meses y 2 anos" = "Between 6 months and 2 years",
      "Entre 2 y 5 anos" = "Between 2 and 5 years",
      "MÃ¡s de 5 anos" = "More than 5 years"
    ),
    `Relationship duration` = replace_na(`Relationship duration`, "Single")
  ) |>
  # Recode relationship type
  mutate(Relationship = recode(`Relationship status`,
    "Exclusiva/No viven juntos" = "Stable",
    "Exclusiva/Matrimonio" = "Stable",
    "No exclusiva" = "Non-stable",
    "Soltero/sin contactos sexuales en un ano" = "Single",
    "Soltero/contactos sexuales en un ano" = "Single"
  )) |>
  # Relevel factors
  mutate(
    Education = fct_relevel(
      Education,
      c("High school", "University", "Postgraduate")
    ),
    `Pornography consumed last month` = fct_relevel(
      `Pornography consumed last month`,
      c(
        "None", "1-2 times",
        "3-5 times", "5 times or more"
      )
    ),
    `Relationship duration` = fct_relevel(
      `Relationship duration`,
      c(
        "Single", "Less that 6 months",
        "Between 6 months and 2 years",
        "Between 2 and 5 years",
        "More than 5 years"
      )
    )
  ) |>
  mutate(
    `Stimuli content` = as.factor(`Stimuli content`),
    `Stimuli sex` = as.factor(`Stimuli sex`)
  ) |>
  # Filter participants in non-stable relationships
  filter(Relationship != "Non-stable") |>
  droplevels()
```

------------------------------------------------------------------------

# Descriptives

### Figure \@ref(fig:sample-plot). Demographic chacarteristics of the sample

Number of participants by demographic category.

```{r sample-plot, results = "hold", fig.height = 7, fig.cap = "Number of participants by gender (left = women, rigth = men), Relationship (stable = top panels, single = bottom panels), Religion (non-religious = left panels by gender, religious = right panels by gender), Education (*X* axis), and pornography consumed during the last month (*Y* axis). The number of participants for each combination of these five variables is displayed as numbers (percentage in brackets), as well as by the color and size of the bubbles .", warning = FALSE, message = FALSE}
# Prepare data for demographic characteristics plot
dat.demog <- dat |> 
  select(
    Participant, Gender, Relationship, Education, Religion, `Pornography consumed last month`
  ) |> 
  group_by(Participant) |> 
  filter(row_number() == 1) |>  # Keep only one row per participant
  ungroup() |> 
  group_by(Gender, Relationship, Education, Religion, `Pornography consumed last month`) |> 
  rename(Porn = `Pornography consumed last month`) |>  # Shorten column name
  tally() |>  # Count occurrences
  drop_na(Religion) |>  # Remove missing values in Religion column
  ungroup()

# Create separate datasets by gender
dat.demog.W <- filter(dat.demog, Gender == "Women")  # Women data
dat.demog.M <- filter(dat.demog, Gender == "Men")  # Men data

# Plot for Women
samp.w <- ggballoonplot(dat.demog.W, 
  x = "Education", y = "Porn", size = "n", fill = "n",
  facet.by = c("Relationship", "Religion")  # Separate facets by relationship & religion
) + 
  scale_fill_viridis_c(option = "C", limits = c(1, max(dat.demog$n))) +  # Color scale
  scale_size_continuous(range = c(1, 7), limits = c(1, max(dat.demog$n))) +  # Size scale
  guides(fill = guide_legend(face = "italic"), size = guide_legend(face = "italic")) +  
  labs(title = "Women", y = "Pornography consumed last month") +  # Labels
  geom_text(aes(label = n), size = 3, nudge_x = 0.3, nudge_y = 0.1) +  # Add counts
  geom_text(
    aes(label = paste0("\n(", percent(n / sum(dat.demog$n), accuracy = 0.1), ")")),  
    size = 2.5, nudge_x = 0.3, nudge_y = -0.05  # Add percentage below counts
  ) + 
  theme_tq() +  # Apply tidyquant theme
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),  # Rotate x-axis text
    axis.text.y = element_text(angle = 45, vjust = 0.5)  # Rotate y-axis text
  )

# Plot for Men
samp.m <- ggballoonplot(dat.demog.M, 
  x = "Education", y = "Porn", size = "n", fill = "n",
  facet.by = c("Relationship", "Religion")  # Separate facets by relationship & religion
) + 
  scale_fill_viridis_c(option = "C", limits = c(1, max(dat.demog$n))) +  # Color scale
  scale_size_continuous(range = c(1, 7), limits = c(1, max(dat.demog$n))) +  # Size scale
  guides(fill = guide_legend(face = "italic"), size = guide_legend(face = "italic")) +  
  labs(title = "Men", y = NULL) +  # Labels
  geom_text(aes(label = n), size = 3, nudge_x = 0.3, nudge_y = 0.1) +  # Add counts
  geom_text(
    aes(label = paste0("\n(", percent(n / sum(dat.demog$n), accuracy = 0.1), ")")),  
    size = 2.5, nudge_x = 0.3, nudge_y = -0.05  # Add percentage below counts
  ) + 
  theme_tq() +  # Apply tidyquant theme
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),  # Rotate x-axis text
    axis.text.y = element_text(angle = 45, vjust = 0.5)  # Rotate y-axis text
  )

# Combine Women & Men plots into a single figure
ggarrange(
  samp.w, samp.m, widths = c(1.1, 1),  # Adjust panel widths
  common.legend = TRUE, legend = "bottom"  # Use a common legend at the bottom
)
```

## Descriptive statistics of the participants by gender

Calculate mean values per participant for relevant, numeric variables.

```{r}
# Compute mean values per participant for selected numeric variables
dat.desc <- dat |> 
  select(
    Participant, Gender, Age, Relationship, `Number of sexual partners`, 
    `MGH-SFQ (total)`, 
    `MGSS sexual satisfaction (General)`, `MGSS sexual satisfaction (Partner)`, 
    `Subjective sexual attractiveness`, `Subjective sexual arousal`, 
    `Solitary sexual desire`, 
    `Dyadic sexual desire (Attractive person)`, `Dyadic sexual desire (Partner)`
  ) |> 
  group_by(Participant, Gender, Relationship) |>  # Group by participant, gender, relationship
  summarize_if(is.numeric, mean, na.rm = TRUE)  # Compute mean for numeric variables
```

### Table \@ref(tab:desciptive-tab). Descriptive statistics of the participants by gender

Table of descriptives by gender.

```{r desciptive-tab}
# Generate a table of descriptive statistics by gender and relationship status
describeBy(dat.desc ~ Relationship + Gender, 
           mat = TRUE, digits = 2  # Convert output to a matrix, round to 2 decimal places
) |> 
  rownames_to_column("Measured characteristic") |>  # Move row names to a column
  select(1, 3:4, 6:9, 12:13) |>  # Select relevant columns
  slice(-(1:12)) |>  # Remove unnecessary rows
  select(1, 3, 2, 4:9) |>  # Reorder columns for better readability
  # Remove numeric suffixes from row names (now in the "Measured characteristic" column)
  mutate("Measured characteristic" = str_replace_all(
    `Measured characteristic`, c("1" = "", "2" = "", "3" = "", "4" = "")
  )) |> 
  # Create formatted table
  kable(
    digits = 2, booktabs = TRUE, align = c("l", "l", rep("c", 7)), linesep = "",
    caption = "Descriptive statistics of the participants by gender and relationship status",
    col.names = c(
      "Measured characteristic", "Gender", "Relationship status",
      "$n$", "Mean", "$SD$", "Median", "Min", "Max"
    ),
    longtable = TRUE, escape = FALSE
  ) |> 
  # Apply LaTeX styling
  kable_styling(latex_options = c("HOLD_position"), font_size = 8.2) |> 
  # Collapse duplicate values in the first three columns for clarity
  collapse_rows(columns = 1:3, valign = "middle") |> 
  # Add a footnote explaining within-subject descriptives
  footnote(
    general = "Because for \\\\textit{Subjective sexual attractiveness} and
           \\\\textit{Subjective sexual arousal}, there are multiple within-subject
           observations, descriptives are calculated from mean values per participant.",
    threeparttable = TRUE, footnote_as_chunk = TRUE, escape = FALSE
  )
```

### Figure \@ref(fig:density-plot). Distribution of participants' measured variables by gender

Kernel density distributions by gender.

```{r density-plot, results = "hold", fig.height = 9, fig.cap = "Distribution of measured variables by gender. Coloured vertical lines represent mean values by gender. Detailed descriptives are found in Table S1. Because for *Subjective sexual attractiveness* and *Subjective sexual arousal* there are are multiple within-subject observations, densities calculated from mean values per participant.", warning = FALSE, message = FALSE}
# Convert dat.desc to long format for easier plotting
datp <- dat.desc |> 
  pivot_longer(
    cols = Age:`Dyadic sexual desire (Partner)`,  # Convert selected columns to long format
    names_to = "Variable", values_to = "Value"
  ) |> 
  mutate(Variable = str_wrap(Variable, width = 30))  # Wrap variable names for better display

# Panel 1: Age, Sexual Partners, and Subjective Sexual Measures
fs2a <- ggplot(
  datp |> filter(Variable %in% c(
    "Age", "Number of sexual partners", 
    "Subjective sexual\nattractiveness", "Subjective sexual arousal"
  )), 
  aes(Value, fill = Gender, colour = Gender)
) + 
  geom_density(alpha = 0.3) +  # Density plot with transparency
  geom_vline(
    data = datp |> 
      filter(Variable %in% c(
        "Age", "Number of sexual partners", 
        "Subjective sexual\nattractiveness", "Subjective sexual arousal"
      )) |> 
      group_by(Variable, Gender) |> 
      summarise(mean = mean(Value, na.rm = TRUE)),  # Compute mean per group
    size = 1, aes(xintercept = mean, color = Gender, linetype = Gender)
  ) + 
  scale_color_manual(values = color.Gender) +  # Custom gender colors
  scale_fill_manual(values = color.Gender) + 
  facet_wrap(~Variable, scales = "free", ncol = 4) +  # Facet by variable
  labs(y = "Density", x = NULL) + 
  theme_tq()  # Apply tidyquant theme

# Panel 2: Sexual Function and Satisfaction
fs2b <- ggplot(
  datp |> filter(Variable %in% c(
    "MGH-SFQ (total)", "MGSS sexual satisfaction\n(General)", 
    "MGSS sexual satisfaction\n(Partner)"
  )), 
  aes(Value, fill = Gender, colour = Gender)
) + 
  geom_density(alpha = 0.3) +  
  geom_vline(
    data = datp |> 
      filter(Variable %in% c(
        "MGH-SFQ (total)", "MGSS sexual satisfaction\n(General)", 
        "MGSS sexual satisfaction\n(Partner)"
      )) |> 
      group_by(Variable, Gender) |> 
      summarise(mean = mean(Value, na.rm = TRUE)),  
    size = 1, aes(xintercept = mean, color = Gender, linetype = Gender)
  ) + 
  scale_color_manual(values = color.Gender) + 
  scale_fill_manual(values = color.Gender) + 
  facet_wrap(~Variable, scales = "free", ncol = 3) +  
  labs(y = "Density", x = NULL) + 
  theme_tq()  

# Panel 3: Sexual Desire Measures
fs2c <- ggplot(
  datp |> filter(Variable %in% c(
    "Solitary sexual desire", "Dyadic sexual desire\n(Attractive person)", 
    "Dyadic sexual desire (Partner)"
  )), 
  aes(Value, fill = Gender, colour = Gender)
) + 
  geom_density(alpha = 0.3) +  
  geom_vline(
    data = datp |> 
      filter(Variable %in% c(
        "Solitary sexual desire", "Dyadic sexual desire\n(Attractive person)", 
        "Dyadic sexual desire (Partner)"
      )) |> 
      group_by(Variable, Gender) |> 
      summarise(mean = mean(Value, na.rm = TRUE)),  
    size = 1, aes(xintercept = mean, color = Gender, linetype = Gender)
  ) + 
  scale_color_manual(values = color.Gender) + 
  scale_fill_manual(values = color.Gender) + 
  facet_wrap(~Variable, scales = "free", ncol = 3) +  
  labs(y = "Density", x = NULL) + 
  theme_tq()  

# Combine the three panels into a single figure
ggarrange(fs2a, fs2b, fs2c, 
  common.legend = TRUE, legend = "bottom", nrow = 3  # Common legend below, 3-row layout
)
```

## Correlations between measured variables

Correlation between numeric variables for women, men, and all participants combined, are reported in Table \@ref(tab:corr-tab).

### Table \@ref(tab:corr-tab). Correlations between measured variables

Correlation matrix table.

```{r corr-tab, message = FALSE, warning = FALSE}
# Compute correlations for women
dat.corr.W <- dat.desc |> 
  ungroup() |> 
  filter(Gender == "Women") |>  # Select only women
  select(Age:`Dyadic sexual desire (Partner)`) |>  # Select numeric variables
  corr.stars() |>  # Compute correlation matrix with significance stars
  rownames_to_column(var = " ")  # Move row names to a column

# Compute correlations for men
dat.corr.M <- dat.desc |> 
  ungroup() |> 
  filter(Gender == "Men") |>  # Select only men
  select(Age:`Dyadic sexual desire (Partner)`) |>  # Select numeric variables
  corr.stars() |>  
  rownames_to_column(var = " ")  

# Compute correlations for all participants combined
dat.corr.All <- dat.desc |> 
  ungroup() |> 
  select(Age:`Dyadic sexual desire (Partner)`) |>  
  corr.stars() |>  
  rownames_to_column(var = " ")  

# Format and combine the correlation tables
bind_rows(dat.corr.W, dat.corr.M, dat.corr.All) |> 
  kable(
    digits = 2, booktabs = TRUE, align = c("l", rep("c", 9)), linesep = "",
    caption = "Correlations between measured variables", escape = FALSE
  ) |> 
  # Add grouped row labels for each participant group
  pack_rows("Women", start_row = 1, end_row = 10, bold = FALSE, background = "lightgray") |>  
  pack_rows("Men", start_row = 11, end_row = 20, bold = FALSE, background = "lightgray") |>  
  pack_rows("All participants", start_row = 21, end_row = 30, bold = FALSE, background = "lightgray") |>  
  # Apply LaTeX styling
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  column_spec(2:10, width = "2.2cm") |>  # Adjust column widths
  # Add footnote explaining correlation significance levels
  footnote(
    general = paste0(
      "Values represent Pearson correlation coefficients ($r$). ",
      "For significance, $^{\\\\dagger}p$ < 0.1, *$p$ < 0.05, ",
      "**$p$ < 0.01, ***$p$ < 0.001. ",
      "Significant correlations are in bold."
    ),
    threeparttable = TRUE, footnote_as_chunk = TRUE, escape = FALSE
  ) |>  
  landscape()  # Rotate table for better readability in LaTeX
```

## Internal consistency

Six variables were calculated from multiple items (1. MGH-SFQ, 2. Dyadic sexual desire (Partner), 3. Solitary sexual desire, 4. Dyadic sexual desire (Attractive person), 5. MGSS sexual satisfaction (General) and 6. MGSS sexual satisfaction (Partner)). 

Data by item, for each participant, is included in the following data base, loaded as `dat.reli`:

```{r}
# Load dataset containing item-level data for internal consistency analysis
dat.reli <- read_excel("Data/BD_ConsistenciaInterna.xlsx") |> 
  # Recode gender variable: 1 = Men, 2 = Women
  mutate(Sex = recode_factor(Sex, "2" = "Women", "1" = "Men")) |> 
  rename(Gender = Sex) |>  # Rename column for consistency with other datasets
  filter(Participante != 122)  # Remove participant 122 from the dataset
```

Participant 122 was excluded because they did not respond the psychological scales.

To measure the internal consistency of these tests, we used standardized Cronbach's alpha ($\alpha$ or Tau-equivalent reliability: $\rho_{T}$) coefficients, using the function `cronbach.alpha` from the package `ltm` [@LtmPackageLatent2006].

Importantly, given that for MGH-SFQ one item was answered only by men, the internal consistency of this variable was measured independently for each gender.

```{r cahe = TRUE}
# Compute standardized Cronbach's alpha (Tau-equivalent reliability) for each measure

# MGH-SFQ for men (selects items 3 to 7, excludes missing values)
MGH.m <- dat.reli |> 
  filter(Gender == "Men") |> 
  select(3:7) |> 
  drop_na() |>  
  cronbach.alpha(CI = TRUE, standardized = TRUE)

# MGH-SFQ for women (excludes item 6, which was answered only by men)
MGH.w <- dat.reli |> 
  filter(Gender == "Women") |> 
  select(3:5, 7) |>  
  drop_na() |>  
  cronbach.alpha(CI = TRUE, standardized = TRUE)

# Dyadic sexual desire (Partner) - items 9 to 13
DSD.p <- dat.reli |> 
  select(9:13) |>  
  drop_na() |>  
  cronbach.alpha(CI = TRUE, standardized = TRUE)

# Solitary sexual desire - items 15 to 18
SSD.p <- dat.reli |> 
  select(15:18) |>  
  drop_na() |>  
  cronbach.alpha(CI = TRUE, standardized = TRUE)

# Dyadic sexual desire (Attractive person) - items 20 to 23
DSD.a <- dat.reli |> 
  select(20:23) |>  
  drop_na() |>  
  cronbach.alpha(CI = TRUE, standardized = TRUE)

# MGSS sexual satisfaction (General) - items 26 to 30
MGSS.g <- dat.reli |> 
  select(26:30) |>  
  drop_na() |>  
  cronbach.alpha(CI = TRUE, standardized = TRUE)

# MGSS sexual satisfaction (Partner) - items 32 to 36
MGSS.p <- dat.reli |> 
  select(32:36) |>  
  drop_na() |>  
  cronbach.alpha(CI = TRUE, standardized = TRUE)
```

### Table \@ref(tab:Cronbach-tab). Internal consistency of construct variables

Table of Cronbach's $\alpha$ for construct variables.

```{r Cronbach-tab,  cahe = TRUE}
# Create a table of Cronbach's alpha values for internal consistency analysis
tibble(
  Variable = c(
    "MGH-SFQ", "MGH-SFQ", 
    "MGSS sexual satisfaction (General)", 
    "MGSS sexual satisfaction (Partner)", 
    "Dyadic TSD Partner", "Solitary TSD", 
    "Dyadic TSD Attractive Person"
  ),
  Gender = c("Men", "Women", rep(" ", 5)),  # Report gender only for MGH-SFQ
  p = c(
    MGH.m$p, MGH.w$p, MGSS.g$p, MGSS.p$p, 
    DSD.p$p, SSD.p$p, DSD.a$p
  ),
  n = c(
    MGH.m$n, MGH.w$n, MGSS.g$n, MGSS.p$n, 
    DSD.p$n, SSD.p$n, DSD.a$n
  ),
  alpha = c(
    MGH.m$alpha, MGH.w$alpha, MGSS.g$alpha, MGSS.p$alpha, 
    DSD.p$alpha, SSD.p$alpha, DSD.a$alpha
  ),
  ci2.5 = c(
    MGH.m$ci[1], MGH.w$ci[1], MGSS.g$ci[1], MGSS.p$ci[1], 
    DSD.p$ci[1], SSD.p$ci[1], DSD.a$ci[1]
  ),
  ci97.5 = c(
    MGH.m$ci[2], MGH.w$ci[2], MGSS.g$ci[2], MGSS.p$ci[2], 
    DSD.p$ci[2], SSD.p$ci[2], DSD.a$ci[2]
  )
) |> 
  kable(
    digits = 2, booktabs = TRUE, align = c("l", "l", rep("c", 5)), linesep = "",
    caption = "Internal consistency of measured variables", escape = FALSE,
    col.names = c(
      "Variable", "Gender", "Items", "$n$", "$\\alpha$", "$2.5\\% CI$", "$97.5\\% CI$"
    )
  ) |> 
  # Merge repeated values in the "Variable" column for better readability
  collapse_rows(columns = 1, valign = "middle") |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = "HOLD_position") |>  
  # Add footnote explaining confidence intervals and reporting choices
  footnote(
    general = "95\\\\% confidence intervals were calculated with 1,000 bootstrap samples. 
           Standardized Cronbach's alpha ($\\\\alpha$) coefficients were computed. 
           MGH-SFQ is reported by gender, because one item was answered only by men.",
    threeparttable = TRUE, footnote_as_chunk = TRUE, escape = FALSE
  )
```

------------------------------------------------------------------------

## Controlling for Relationship Duration and MGSS Sexual Satisfaction (Partner) in Sexual Desire Dimensions

To **ensure that the three sexual desire dimensions were not influenced by Relationship Duration or MGSS sexual satisfaction (Partner)**, we applied a three-step adjustment process:

1. **Estimating the effects:**  
   - We performed separate **linear regressions** where each sexual desire dimension was predicted by **Relationship Duration** and **MGSS sexual satisfaction (Partner)**.
   - This allowed us to quantify how much these external factors influence each dimension.

2. **Evaluating statistical significance:**  
   - We conducted **Type III ANOVA** to determine which predictors had a significant effect on each sexual desire dimension.
   - Only **MGSS sexual satisfaction (Partner) significantly predicted Dyadic Sexual Desire (Partner)**.

3. **Removing the effects:**  
   - We adjusted **only Dyadic Sexual Desire (Partner)** by extracting the **residuals** from the regression model.
   - These residuals represent the **variation independent of MGSS sexual satisfaction (Partner)** and were then standardized for comparability.

Additionally, **MGSS sexual satisfaction (Partner) was mean-centered** before analysis.

**Step 1**: Estimating the Effects of Relationship Duration & Partner Satisfaction

```{r}
# Select participants in stable relationships and ensure required variables are available
dat_ctl <- dat |> 
  group_by(Participant) |> 
  slice_head() |>  # Retain only the first occurrence per participant
  filter(Relationship == "Stable") |>  # Include only participants in stable relationships
  ungroup()

# Fit linear models predicting each sexual desire dimension

# Model predicting Solitary Sexual Desire 
ctl_SSD <- lm(
  `Solitary sexual desire` ~ `Relationship duration` + `MGSS sexual satisfaction (Partner)`,
  data = dat_ctl
)

# Model predicting Dyadic Sexual Desire (Partner) 
ctl_PD <- lm(
  `Dyadic sexual desire (Partner)` ~ `Relationship duration` + `MGSS sexual satisfaction (Partner)`,
  data = dat_ctl
)

# Model predicting Dyadic Sexual Desire (Attractive Person) 
ctl_APD <- lm(
  `Dyadic sexual desire (Attractive person)` ~ `Relationship duration` + 
    `MGSS sexual satisfaction (Partner)`,
  data = dat_ctl
)
```

**Step 2**: Displaying ANOVA Results for Each Model

The table below presents Type III ANOVA results for each model. Significant effects indicate that Relationship Duration or Partner Satisfaction meaningfully predict the corresponding sexual desire dimension.

```{r message = FALSE}
# Compute ANOVA results and effect sizes for all models
anova_results <- bind_cols(
  bind_cols(
    anova_summary(Anova(ctl_SSD, type = 3)),  # Type III ANOVA for Solitary Sexual Desire
    epsilon_squared(ctl_SSD)  # Compute partial epsilon squared
  ) |> 
    unite(col = "df", DFn:DFd, sep = ", "),  # Combine numerator and denominator df
  bind_cols(
    anova_summary(Anova(ctl_PD, type = 3)),  # Type III ANOVA for Dyadic Sexual Desire (Partner)
    epsilon_squared(ctl_PD)
  ) |> 
    unite(col = "df", DFn:DFd, sep = ", "),  
  bind_cols(
    anova_summary(Anova(ctl_APD, type = 3)),  # Type III ANOVA for Dyadic Sexual Desire (Attractive)
    epsilon_squared(ctl_APD)
  ) |> 
    unite(col = "df", DFn:DFd, sep = ", ")  
) |> 
  # Remove unnecessary columns related to Sum of Squares and CI
  select(-starts_with(c("p<.05", "ges...", "Parameter...", "CI"))) |>  
  # Format p-values for LaTeX
  mutate(across(starts_with("p..."), pval.lev)) |>  
  rename(Effect = Effect...1) |>  # Rename effect column
  # Remove redundant effect columns and clean effect names
  select(-starts_with("Effect...")) |>  
  mutate_at("Effect", str_replace_all, "`", "")  

# Create a formatted ANOVA results table
anova_results |>  
  kable(
    booktabs = TRUE, align = c("l", rep("c", 9)), digits = 3, escape = FALSE,
    caption = "Effects of relationship duration and MGSS sexual satisfaction (Partner) in
                   sexual desire dimensions",
    col.names = c("Effect", rep(c("$df$", "$F$", "$p$", "$\\epsilon^2_p$"), times = 3))
  ) |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  # Add section headers for the three models
  add_header_above(c(
    " " = 1,
    "Solitary sexual desire" = 4,
    "Dyadic sexual desire\n(Partner)" = 4,
    "Dyadic sexual desire\n(Attractive person)" = 4
  )) |>  
  # Add footnote explaining effect sizes and significance
  footnote(
    general = "As effect size, we report partial epsilon squared
                     ($\\\\epsilon^2_p$), which provides a less biased
                     estimate than $\\\\eta^2$ (see
                     \\\\cite{albersWhenPowerAnalyses2018}).
                     Significant effects are in bold.",
    threeparttable = TRUE, footnote_as_chunk = TRUE, escape = FALSE
  )
```

**Step 3**: Controlling Scores Based on ANOVA Results

From the ANOVA results, only the effect of MGSS sexual satisfaction (Partner) on Dyadic sexual desire (Partner) was significant. Thus, only Dyadic Sexual Desire (Partner) scores were adjusted, while the other dimensions remained unchanged.

```{r}
# Prepare dataset with relevant variables and remove missing values
dat_tl_PD_fin <- dat_ctl |> 
  select(
    Participant, `Dyadic sexual desire (Partner)`, `MGSS sexual satisfaction (Partner)`
  ) |>  
  drop_na()  # Remove rows with missing values

# Fit a linear model predicting Dyadic Sexual Desire (Partner) using partner satisfaction
ctl_PD_fin <- lm(
  `Dyadic sexual desire (Partner)` ~ `MGSS sexual satisfaction (Partner)`, 
  data = dat_tl_PD_fin
)

# Adjust Dyadic Sexual Desire (Partner) scores using residuals from the regression model
dat_ctl <- dat_tl_PD_fin |> 
  mutate(
    `Dyadic sexual desire (Partner)` = 
      mean(`Dyadic sexual desire (Partner)`) + resid(ctl_PD_fin)  # Centered residuals
  )

# Update the original dataset with adjusted scores for Dyadic Sexual Desire (Partner)
dat <- dat |> 
  mutate(`Dyadic sexual desire (Partner)` = as.numeric(`Dyadic sexual desire (Partner)`)) |>  
  rows_update(
    dat_ctl |> select(-`MGSS sexual satisfaction (Partner)`),  # Remove predictor column
    by = "Participant", unmatched = "ignore"  # Match by participant ID
  )
```

------------------------------------------------------------------------

# Hypothesis tests

## Hypothesis 1: All dimensions of trait sexual desire (TSD) will be higher in men than in women, and the differences will be stronger or weaker according to relationship status {#hyp1}

We tested whether relationship type and gender interact as predictors of sexual desire (H1a: Solitary TSD; H1b: Dyadic TSD toward an attractive person; H1c: Dyadic TSD toward a partner). To examine this hypothesis, we modeled the effects of relationship type and gender on each of the three TSD scores.

However, models using the original TSD scores did not meet the assumption of normally distributed residuals. To address this, we applied an ordered normalization transformation to each TSD variable. We then fitted and compared models predicting both the original (as a proportion, to make scores comparable) and transformed (normalized) TSD dimensions. In all three cases, models using the normalized variables provided a better fit, so all inferences are based on these models.

### Data

A data frame was created with one row per participant, where sexual desire variables were normalized as proportions. An ordered quantile normalization transformation [@petersonOrderedQuantileNormalization2020a] was then applied using the `orderNorm` function from the `bestNormalize` package [@bestNormalizecit], and the transformed values were added as new variables.

```{r message = FALSE, warning = FALSE}
# Process the dataset and create transformed variables
dat_m1 <- dat |> 
  group_by(Participant) |> 
  slice_head() |>  # Retain only the first observation per participant
  ungroup() |>  
  # Create proportion variables to normalize each sexual desire measure
  mutate(
    "Solitary sexual desire (proportion)" = `Solitary sexual desire` / 31,
    "Dyadic TSD Attractive Person (proportion)" = 
      `Dyadic sexual desire (Attractive person)` / 32,
    "Dyadic TSD Partner (proportion)" = `Dyadic sexual desire (Partner)` / 38
  )

# Apply ordered normalization transformations to the proportion variables
trs_SSD <- orderNorm(dat_m1$`Solitary sexual desire (proportion)`)  
trs_DSDat <- orderNorm(dat_m1$`Dyadic TSD Attractive Person (proportion)`)  
trs_DSDpt <- orderNorm(dat_m1$`Dyadic TSD Partner (proportion)`)  

# Add the transformed variables back into the dataset
dat_m1 <- dat_m1 |>  
  mutate(
    "Solitary TSD (normalized)" = predict(trs_SSD),  # Transformed Solitary TSD
    "Dyadic TSD Attractive Person (normalized)" = predict(trs_DSDat),  
    "Dyadic TSD Partner (normalized)" = predict(trs_DSDpt)  
  )  
```

### Hypothesis 1a: Solitary TSD {#hypothesis1a}

#### Model the effects of relationship type and gender on Solitary TSD

We fitted models with both the original (proportion; `m1a_prop`) and transformed (normalized; `m1a_norm`) TSD scores, and performed posterior predictive checks (PPCs). As shown elsewhere [e.g., @gabryVisualizationBayesianWorkflow2019], if simulated data from one model are more similar to the observed outcome, that model is likely to be preferred.

```{r}
# Fit a linear model using the original proportion-based Solitary TSD scores
m1a_prop <- lm(
  `Solitary sexual desire (proportion)` ~ Gender * Relationship, data = dat_m1
)

# Fit a linear model using the normalized Solitary TSD scores
m1a_norm <- lm(
  `Solitary TSD (normalized)` ~ Gender * Relationship, data = dat_m1
)
```

##### Figure \@ref(fig:ppc-m1a): Posterior predictive checks (PPCs) for Hypothesis 1a. 

PPCs were performed using the `check_model` function from the `performance` package [@ludecke2021], and reported in Fig. \@ref(fig:ppc-m1a). Simulated data from the normalized Solitary TSD model (Fig. \@ref(fig:ppc-m1a)b) are more similar to the observed outcome, so this model is preferred.

```{r ppc-m1a, message = FALSE, fig.height = 4, fig.cap = "Posterior predictive check. **(a)** Original (proportion) Solitary TSD; **(b)** Transformed (normalized) Solitary TSD. In both panels, red lines represent the observed data, and thin black lines represent 50 iterations of simulated data from each model. "}
# Perform posterior predictive checks (PPC) and arrange them into a single figure
ppc_m1a <- ggarrange(
  # PPC plot for the original (proportion) Solitary TSD model
  plot(
    check_model(m1a_prop, panel = FALSE, check = "pp_check")$PP_CHECK,  
    colors = c("red", "grey30")  # Red for observed data, grey for simulated data
  ) +  
    labs(title = NULL, subtitle = NULL) +  
    theme_tq() +  # Apply tidyquant theme
    facet_wrap(~1, labeller = as_labeller(c(
      "1" = "Original (proportion) Solitary TSD"
    ))),  
  # PPC plot for the transformed (normalized) Solitary TSD model
  plot(
    check_model(m1a_norm, panel = FALSE, check = "pp_check")$PP_CHECK,  
    colors = c("red", "grey30")  
  ) +  
    labs(title = NULL, subtitle = NULL) +  
    theme_tq() +  
    facet_wrap(~1, labeller = as_labeller(c(
      "1" = "Transformed (normalized) Solitary TSD"
    ))),  
  labels = "auto",  # Automatically label subplots (a, b)
  common.legend = TRUE, legend = "bottom"  # Use a common legend at the bottom
)

# Display the final PPC figure
ppc_m1a
```

#### Table \@ref(tab:tab-m1a). ANOVA-type table for the interaction between `Relationship type`, and `Gender`

This tables summarizes the results of the model.

```{r tab-m1a}
# Generate an ANOVA table summarizing the effects of Relationship Type and Gender on Solitary TSD
anova.sig.lm(
  model = m1a_norm,  
  custom_caption = "Effects of relationship type and gender on Solitary TSD"
)
```

#### *Post-hoc* comparisons

Because the main effects of gender, relationship type, and their interaction are significant, we explored these effects using estimated marginal means.

##### Table \@ref(tab:tab-m1a-emm1). Estimated marginal means and contrasts between participants' gender.

Table of estimated marginal means and contrasts between genders. All estimated marginal means and contrasts were calculated using the `emmeans` function from the `emmeans` package [@emmeanscit].

```{r tab-m1a-emm1, message = FALSE}
# Compute estimated marginal means (EMMs) for Gender from the model
emms.m1a1 <- emmeans(m1a_norm, ~Gender)  

# Convert EMM results to a tibble for easier manipulation
emms.m1a1.tab <- tibble(data.frame(emms.m1a1))  

# Compute post-hoc contrasts and format p-values
t.m1a1 <- contr.stars(emms.m1a1) |>  
  mutate(p.value = pval.lev(p.value))  # Format p-values for LaTeX

# Merge EMM and contrast results, clean column names, and format output
merge(emms.m1a1.tab, t.m1a1, by = 0, all = TRUE) |>  
  select(-c(1, 15)) |>  # Remove unnecessary columns
  unite(Contrast, group1, group2, sep = " - ") |>  # Create contrast labels
  mutate_at("Contrast", str_replace_all, "NA - NA", " ") |>  # Replace missing contrasts
  # Create formatted table
  kable(
    digits = 2, booktabs = TRUE, align = c("l", rep("c", 5), "l", rep("c", 5)), linesep = "",
    caption = "Estimated marginal means and contrasts between participants' gender", escape = FALSE,
    col.names = c(
      "Gender", "EMM", "$SE$", "$df$", "$2.5\\% CI$", "$97.5\\% CI$",  
      "Contrast", "Difference", "$SE$", "$df$", "$t$", "$p$"
    )
  ) |>  
  # Add a header separating EMMs and contrasts
  add_header_above(c(" " = 6, "Contrasts" = 6)) |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  # Add footnote explaining significance formatting
  footnote(
    general = "Significant effects are in bold.", threeparttable = TRUE,  
    footnote_as_chunk = TRUE, escape = FALSE
  )
```

##### Table \@ref(tab:tab-m1a-emm2). Estimated marginal means and contrasts between relationship status.

Table of estimated marginal means and contrasts between relationship status. All estimated marginal means and contrasts were calculated using the `emmeans` function from the `emmeans` package [@emmeanscit].

```{r tab-m1a-emm2, message = FALSE}
# Compute estimated marginal means (EMMs) for Relationship Status from the model
emms.m1a2 <- emmeans(m1a_norm, ~Relationship)  

# Convert EMM results to a tibble for easier manipulation
emms.m1a2.tab <- tibble(data.frame(emms.m1a2))  

# Compute post-hoc contrasts and format p-values
t.m1a2 <- contr.stars(emms.m1a2) |>  
  mutate(p.value = pval.lev(p.value))  # Format p-values for LaTeX

# Merge EMM and contrast results, clean column names, and format output
merge(emms.m1a2.tab, t.m1a2, by = 0, all = TRUE) |>  
  select(-c(1, 15)) |>  # Remove unnecessary columns
  unite(Contrast, group1, group2, sep = " - ") |>  # Create contrast labels
  mutate_at("Contrast", str_replace_all, "NA - NA", " ") |>  # Replace missing contrasts
  # Create formatted table
  kable(
    digits = 2, booktabs = TRUE, align = c("l", rep("c", 5), "l", rep("c", 5)), linesep = "",
    caption = "Estimated marginal means and contrasts between relationship status", escape = FALSE,
    col.names = c(
      "Relationship type", "EMM", "$SE$", "$df$", "$2.5\\% CI$", "$97.5\\% CI$",  
      "Contrast", "Difference", "$SE$", "$df$", "$t$", "$p$"
    )
  ) |>  
  # Add a header separating EMMs and contrasts
  add_header_above(c(" " = 6, "Contrasts" = 6)) |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  # Add footnote explaining significance formatting
  footnote(
    general = "Significant effects are in bold.", threeparttable = TRUE,  
    footnote_as_chunk = TRUE, escape = FALSE
  )
```

##### Table \@ref(tab:tab-m1a-emm3). Estimated marginal means and contrasts between gender by relationship status.

Table of estimated marginal means and contrasts between gender by relationship status. All estimated marginal means and contrasts were calculated using the `emmeans` function from the `emmeans` package [@emmeanscit].

```{r tab-m1a-emm3, message = FALSE}
# Compute estimated marginal means (EMMs) for Gender within each Relationship Status
emms.m1a3 <- emmeans(m1a_norm, ~ Gender | Relationship)  

# Convert EMM results to a tibble for easier manipulation
emms.m1a3.tab <- tibble(data.frame(emms.m1a3))  

# Compute post-hoc contrasts and format p-values
t.m1a3 <- contr.stars(emms.m1a3) |>  
  mutate(p.value = pval.lev(p.value))  # Format p-values for LaTeX

# Insert NA rows to maintain table structure for grouped relationship status display
t.m1a3.f <- t.m1a3 |>  
  insertRows(2, new = NA) |>  # Insert empty row after first contrast
  insertRows(4, new = NA)  # Insert empty row after second contrast

# Merge EMM and contrast results, clean column names, and format output
merge(emms.m1a3.tab, t.m1a3.f, by = 0, all = TRUE) |>  
  select(-c(1, 3, 11, 17)) |>  # Remove unnecessary columns
  drop_na(Gender) |>  # Ensure Gender column is complete
  unite(Contrast, group1, group2, sep = " - ") |>  # Create contrast labels
  mutate_at("Contrast", str_replace_all, "NA - NA", "") |>  # Replace missing contrasts
  # Create formatted table
  kable(
    digits = 2, booktabs = TRUE, align = c("l", "l", rep("c", 5), "l", rep("c", 5)), linesep = "",
    caption = "Estimated marginal means and contrasts between gender by relationship status", 
    escape = FALSE,
    col.names = c(
      "Gender", "EMM", "$SE$", "$df$", "$2.5\\% CI$", "$97.5\\% CI$",  
      "Contrast", "Difference", "$SE$", "$df$", "$t$", "$p$"
    )
  ) |>  
  # Add grouped row labels for Relationship Status
  pack_rows("Relationship status: Stable", start_row = 1, end_row = 2,  
    bold = FALSE, background = "lightgray") |>  
  pack_rows("Relationship status: Single", start_row = 3, end_row = 4,  
    bold = FALSE, background = "lightgray") |>  
  # Add a header separating EMMs and contrasts
  add_header_above(c(" " = 6, "Contrasts" = 6)) |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  # Add footnote explaining significance formatting
  footnote(
    general = "Significant effects are in bold.", threeparttable = TRUE,  
    footnote_as_chunk = TRUE, escape = FALSE
  )
```

#### Figure \@ref(fig:fig-h1a). Effects of gender and relationship type on  Solitary TSD

This figure summarizes the results of hypothesis 1a.

```{r fig-h1a, results = "hold", fig.height = 4, fig.cap = "Effects of gender and relationship type on  Solitary TSD. Solitary sexual desire was transformed using ordered quantile normalization [@petersonOrderedQuantileNormalization2020a]. **(a)** Simple comparison between sexual desire by gender (for detailed results, see Table \\@ref(tab:tab-m1a-emm1)); **(b)** Simple comparison between relationship status levels (for detailed results, see Table \\@ref(tab:tab-m1a-emm2)); **(c)** Interaction between relationship type and relationship status (see Table \\@ref(tab:tab-m1a); for detailed results, see Table \\@ref(tab:tab-m1a-emm3)). Dots and bars represent estimated marginal means and 95% CI. In all cases, significant effects are represented with lines and stars: \\**p* < 0.05, \\*\\**p* < 0.01, \\*\\*\\**p* < 0.001, \\*\\*\\*\\**p* < 0.0001.", warning = FALSE, message = FALSE}
# Plot (a): Main effect of Gender on Solitary TSD
h1a1 <- ggplot(dat_m1, aes(
  x = Gender, y = `Solitary TSD (normalized)`, color = Gender
)) + 
  scale_color_manual(values = color.Gender) +  
  scale_fill_manual(values = color.Gender) +  
  geom_linerange(
    data = emms.m1a1.tab |> rename("Solitary TSD (normalized)" = emmean),
    mapping = aes(ymin = lower.CL, ymax = upper.CL)
  ) +  
  geom_point(
    data = emms.m1a1.tab |> rename("Solitary TSD (normalized)" = emmean),
    position = position_dodge(0.1), size = 3
  ) +  
  stat_pvalue_manual(t.m1a1, label = "p.signif", y.position = 0.55, tip.length = 0) +  
  guides(color = "none") +  
  theme_tq()  

# Plot (b): Main effect of Relationship on Solitary TSD
h1a2 <- ggplot(dat_m1, aes(
  x = Relationship, y = `Solitary TSD (normalized)`, color = Relationship
)) +  
  scale_color_manual(values = color.Relationship) +  
  scale_fill_manual(values = color.Relationship) +  
  geom_linerange(
    data = emms.m1a2.tab |> rename("Solitary TSD (normalized)" = emmean),
    mapping = aes(ymin = lower.CL, ymax = upper.CL)
  ) +  
  geom_point(
    data = emms.m1a2.tab |> rename("Solitary TSD (normalized)" = emmean),
    position = position_dodge(0.1), size = 3
  ) +  
  stat_pvalue_manual(t.m1a2, label = "p.signif", y.position = 0.45, tip.length = 0) +  
  guides(color = "none") +  
  theme_tq()  

# Plot (c): Gender × Relationship Interaction on Solitary TSD
h1a3 <- ggplot(dat_m1, aes(
  x = Gender, y = `Solitary TSD (normalized)`, color = Gender
)) +  
  scale_color_manual(values = color.Gender) +  
  scale_fill_manual(values = color.Gender) +  
  facet_wrap(~Relationship) +  
  geom_linerange(
    data = emms.m1a3.tab |> rename("Solitary TSD (normalized)" = emmean),
    mapping = aes(ymin = lower.CL, ymax = upper.CL)
  ) +  
  geom_point(
    data = emms.m1a3.tab |> rename("Solitary TSD (normalized)" = emmean),
    position = position_dodge(0.1), size = 3
  ) +  
  stat_pvalue_manual(t.m1a3, label = "p.signif", y.position = 0.7, tip.length = 0) +  
  guides(color = "none") +  
  theme_tq()  

# Combine the three plots into a single figure
p1a <- ggarrange(h1a1, h1a2 + labs(y = NULL), h1a3 + labs(y = NULL),  
  ncol = 3, labels = "auto", widths = c(1, 1, 1.5)  # Adjust widths for better alignment
)

# Display the final figure
p1a
```

### Hypothesis 1b: Dyadic TSD (Attractive person) {#hypothesis1b}

#### Model the effects of relationship type and gender on Dyadic TSD: Attractive person

We fitted models with both the original (proportion; `m1b_prop`) and transformed (normalized; `m1b_norm`) TSD scores, and performed posterior predictive checks (PPCs). As shown elsewhere [e.g., @gabryVisualizationBayesianWorkflow2019], if simulated data from one model are more similar to the observed outcome, that model is likely to be preferred.

```{r}
# Set contrast options for sum coding (useful for ANOVA-like interpretation)
options(contrasts = c("contr.sum", "contr.poly"))  

# Fit a linear model using the original proportion-based Dyadic TSD (Attractive Person) scores
m1b_prop <- lm(
  `Dyadic TSD Attractive Person (proportion)` ~ Gender * Relationship, 
  data = dat_m1
)

# Fit a linear model using the normalized Dyadic TSD (Attractive Person) scores
m1b_norm <- lm(
  `Dyadic TSD Attractive Person (normalized)` ~ Gender * Relationship, 
  data = dat_m1
)
```

##### Figure \@ref(fig:ppc-m1b): Posterior predictive checks (PPCs) for Hypothesis 1b. 

PPCs were performed using the `check_model` function from the `performance` package [@ludecke2021], and reported in Fig. \@ref(fig:ppc-m1b). Simulated data from the normalized Solitary TSD model (Fig. \@ref(fig:ppc-m1b)b) are more similar to the observed outcome, so this model is preferred.

```{r ppc-m1b, message = FALSE, fig.height = 4, fig.cap = "Posterior predictive check. **(a)** Original (proportion) Solitary TSD; **(b)** Transformed (normalized) Solitary TSD. In both panels, red lines represent the observed data, and thin black lines represent 50 iterations of simulated data from each model. "}
# Perform posterior predictive checks (PPC) and arrange them into a single figure
ppc_m1b <- ggarrange(
  # PPC plot for the original (proportion) Dyadic TSD: Attractive Person model
  plot(
    check_model(m1b_prop, panel = FALSE, check = "pp_check")$PP_CHECK,  
    colors = c("red", "grey30")  # Red for observed data, grey for simulated data
  ) +  
    labs(title = NULL, subtitle = NULL) +  
    theme_tq() +  
    facet_wrap(~1, labeller = as_labeller(c(
      "1" = "Original (proportion) Dyadic TSD: Attractive person"
    ))),  
  # PPC plot for the transformed (normalized) Dyadic TSD: Attractive Person model
  plot(
    check_model(m1b_norm, panel = FALSE, check = "pp_check")$PP_CHECK,  
    colors = c("red", "grey30")  
  ) +  
    labs(title = NULL, subtitle = NULL) +  
    theme_tq() +  
    facet_wrap(~1, labeller = as_labeller(c(
      "1" = "Transformed (normalized) Dyadic TSD: Attractive person"
    ))),  
  labels = "auto",  # Automatically label subplots (a, b)
  common.legend = TRUE, legend = "bottom"  # Use a common legend at the bottom
)

# Display the final PPC figure
ppc_m1b
```

#### Table \@ref(tab:tab-m1b). ANOVA-type table for the interaction between `Relationship type`, and `Gender`

This tables summarizes the results of the model.

```{r tab-m1b}
# Generate an ANOVA table summarizing the effects of Relationship Type and Gender on  
# Dyadic TSD Attractive Person
anova.sig.lm(
  model = m1b_norm,  
  custom_caption = "Effects of relationship type and gender on Dyadic TSD Attractive Person"
)
```

#### *Post-hoc* comparisons

Because the main effects of gender and relationship type, but not their interaction, are significant, we explored these effects using estimated marginal means.

##### Table \@ref(tab:tab-m1b-emm1). Estimated marginal means and contrasts between participants' gender.

Table of estimated marginal means and contrasts between genders. All estimated marginal means and contrasts were calculated using the `emmeans` function from the `emmeans` package [@emmeanscit].

```{r tab-m1b-emm1, message = FALSE}
# Compute estimated marginal means (EMMs) for Gender from the model
emms.m1b1 <- emmeans(m1b_norm, ~Gender)  

# Convert EMM results to a tibble for easier manipulation
emms.m1b1.tab <- tibble(data.frame(emms.m1b1))  

# Compute post-hoc contrasts and format p-values
t.m1b1 <- contr.stars(emms.m1b1) |>  
  mutate(p.value = pval.lev(p.value))  # Format p-values for LaTeX

# Merge EMM and contrast results, clean column names, and format output
merge(emms.m1b1.tab, t.m1b1, by = 0, all = TRUE) |>  
  select(-c(1, 15)) |>  # Remove unnecessary columns
  unite(Contrast, group1, group2, sep = " - ") |>  # Create contrast labels
  mutate_at("Contrast", str_replace_all, "NA - NA", " ") |>  # Replace missing contrasts
  # Create formatted table
  kable(
    digits = 2, booktabs = TRUE, align = c("l", rep("c", 5), "l", rep("c", 5)), linesep = "",
    caption = "Estimated marginal means and contrasts between participants' gender", 
    escape = FALSE,
    col.names = c(
      "Gender", "EMM", "$SE$", "$df$", "$2.5\\% CI$", "$97.5\\% CI$",  
      "Contrast", "Difference", "$SE$", "$df$", "$t$", "$p$"
    )
  ) |>  
  # Add a header separating EMMs and contrasts
  add_header_above(c(" " = 6, "Contrasts" = 6)) |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  # Add footnote explaining significance formatting
  footnote(
    general = "Significant effects are in bold.", threeparttable = TRUE,  
    footnote_as_chunk = TRUE, escape = FALSE
  )
```

##### Table \@ref(tab:tab-m1b-emm2). Estimated marginal means and contrasts between relationship status.

Table of estimated marginal means and contrasts between relationship status. All estimated marginal means and contrasts were calculated using the `emmeans` function from the `emmeans` package [@emmeanscit].

```{r tab-m1b-emm2, message = FALSE}
# Compute estimated marginal means (EMMs) for Relationship Status from the model
emms.m1b2 <- emmeans(m1b_norm, ~Relationship)  

# Convert EMM results to a tibble for easier manipulation
emms.m1b2.tab <- tibble(data.frame(emms.m1b2))  

# Compute post-hoc contrasts and format p-values
t.m1b2 <- contr.stars(emms.m1b2) |>  
  mutate(p.value = pval.lev(p.value))  # Format p-values for LaTeX

# Merge EMM and contrast results, clean column names, and format output
merge(emms.m1b2.tab, t.m1b2, by = 0, all = TRUE) |>  
  select(-c(1, 15)) |>  # Remove unnecessary columns
  unite(Contrast, group1, group2, sep = " - ") |>  # Create contrast labels
  mutate_at("Contrast", str_replace_all, "NA - NA", " ") |>  # Replace missing contrasts
  # Create formatted table
  kable(
    digits = 2, booktabs = TRUE, align = c("l", rep("c", 5), "l", rep("c", 5)), linesep = "",
    caption = "Estimated marginal means and contrasts between relationship status", 
    escape = FALSE,
    col.names = c(
      "Relationship type", "EMM", "$SE$", "$df$", "$2.5\\% CI$", "$97.5\\% CI$",  
      "Contrast", "Difference", "$SE$", "$df$", "$t$", "$p$"
    )
  ) |>  
  # Add a header separating EMMs and contrasts
  add_header_above(c(" " = 6, "Contrasts" = 6)) |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  # Add footnote explaining significance formatting
  footnote(
    general = "Significant effects are in bold.", threeparttable = TRUE,  
    footnote_as_chunk = TRUE, escape = FALSE
  )
```

##### Table \@ref(tab:tab-m1b-emm3). Estimated marginal means and contrasts between gender by relationship status.

Table of estimated marginal means and contrasts between gender by relationship status. All estimated marginal means and contrasts were calculated using the `emmeans` function from the `emmeans` package [@emmeanscit].

```{r tab-m1b-emm3, message = FALSE}
# Compute estimated marginal means (EMMs) for Gender within each Relationship Status
emms.m1b3 <- emmeans(m1b_norm, ~ Gender | Relationship)  

# Convert EMM results to a tibble for easier manipulation
emms.m1b3.tab <- tibble(data.frame(emms.m1b3))  

# Compute post-hoc contrasts and format p-values
t.m1b3 <- contr.stars(emms.m1b3) |>  
  mutate(p.value = pval.lev(p.value))  # Format p-values for LaTeX

# Insert NA rows to maintain table structure for grouped relationship status display
t.m1b3.f <- t.m1b3 |>  
  insertRows(2, new = NA) |>  # Insert empty row after first contrast
  insertRows(4, new = NA)  # Insert empty row after second contrast

# Merge EMM and contrast results, clean column names, and format output
merge(emms.m1b3.tab, t.m1b3.f, by = 0, all = TRUE) |>  
  select(-c(1, 3, 11, 17)) |>  # Remove unnecessary columns
  drop_na(Gender) |>  # Ensure Gender column is complete
  unite(Contrast, group1, group2, sep = " - ") |>  # Create contrast labels
  mutate_at("Contrast", str_replace_all, "NA - NA", "") |>  # Replace missing contrasts
  # Create formatted table
  kable(
    digits = 2, booktabs = TRUE, align = c("l", "l", rep("c", 5), "l", rep("c", 5)), linesep = "",
    caption = "Estimated marginal means and contrasts between gender by relationship status", 
    escape = FALSE,
    col.names = c(
      "Gender", "EMM", "$SE$", "$df$", "$2.5\\% CI$", "$97.5\\% CI$",  
      "Contrast", "Difference", "$SE$", "$df$", "$t$", "$p$"
    )
  ) |>  
  # Add grouped row labels for Relationship Status
  pack_rows("Relationship status: Stable", start_row = 1, end_row = 2,  
    bold = FALSE, background = "lightgray") |>  
  pack_rows("Relationship status: Single", start_row = 3, end_row = 4,  
    bold = FALSE, background = "lightgray") |>  
  # Add a header separating EMMs and contrasts
  add_header_above(c(" " = 6, "Contrasts" = 6)) |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  # Add footnote explaining significance formatting
  footnote(
    general = "Significant effects are in bold.", threeparttable = TRUE,  
    footnote_as_chunk = TRUE, escape = FALSE
  )
```

#### Figure \@ref(fig:fig-h1b). Effects of gender and relationship type on Dyadic TSD Attractive Person

This figure summarizes the results of hypothesis 1b.

```{r fig-h1b, results = "hold", fig.height = 4, fig.cap = "Effects of gender and relationship type on Dyadic TSD Attractive Person. Dyadic TSD Attractive Person was transformed using ordered quantile normalization [@petersonOrderedQuantileNormalization2020a]. **(a)** Simple comparison between sexual desire by gender (for detailed results, see Table \\@ref(tab:tab-m1b-emm1)); **(b)** Simple comparison between relationship status levels (for detailed results, see Table \\@ref(tab:tab-m1b-emm2)); **(c)** Interaction between relationship type and relationship status (see Table \\@ref(tab:tab-m1b); for detailed results, see Table \\@ref(tab:tab-m1b-emm3)). Dots and bars represent estimated marginal means and 95% CI. In all cases, significant effects are represented with lines and stars: \\**p* < 0.05, \\*\\**p* < 0.01, \\*\\*\\**p* < 0.001, \\*\\*\\*\\**p* < 0.0001.", warning = FALSE, message = FALSE}
# Plot (a): Main effect of Gender on Dyadic TSD Attractive Person
h1b1 <- ggplot(dat_m1, aes(
  x = Gender, y = `Dyadic TSD Attractive Person (normalized)`, color = Gender
)) +  
  scale_color_manual(values = color.Gender) +  
  scale_fill_manual(values = color.Gender) +  
  geom_linerange(
    data = emms.m1b1.tab |> rename("Dyadic TSD Attractive Person (normalized)" = emmean),
    mapping = aes(ymin = lower.CL, ymax = upper.CL)
  ) +  
  geom_point(
    data = emms.m1b1.tab |> rename("Dyadic TSD Attractive Person (normalized)" = emmean),
    position = position_dodge(0.1), size = 3
  ) +  
  stat_pvalue_manual(t.m1b1, label = "p.signif", y.position = 0.6, tip.length = 0) +  
  guides(color = "none") +  
  theme_tq()  

# Plot (b): Main effect of Relationship on Dyadic TSD Attractive Person
h1b2 <- ggplot(dat_m1, aes(
  x = Relationship, y = `Dyadic TSD Attractive Person (normalized)`, color = Relationship
)) +  
  scale_color_manual(values = color.Relationship) +  
  scale_fill_manual(values = color.Relationship) +  
  geom_linerange(
    data = emms.m1b2.tab |> rename("Dyadic TSD Attractive Person (normalized)" = emmean),
    mapping = aes(ymin = lower.CL, ymax = upper.CL)
  ) +  
  geom_point(
    data = emms.m1b2.tab |> rename("Dyadic TSD Attractive Person (normalized)" = emmean),
    position = position_dodge(0.1), size = 3
  ) +  
  stat_pvalue_manual(t.m1b2, label = "p.signif", y.position = 0.45, tip.length = 0) +  
  guides(color = "none") +  
  theme_tq()  

# Plot (c): Gender × Relationship Interaction on Dyadic TSD Attractive Person
h1b3 <- ggplot(dat_m1, aes(
  x = Gender, y = `Dyadic TSD Attractive Person (normalized)`, color = Gender
)) +  
  scale_color_manual(values = color.Gender) +  
  scale_fill_manual(values = color.Gender) +  
  facet_wrap(~Relationship) +  
  geom_linerange(
    data = emms.m1b3.tab |> rename("Dyadic TSD Attractive Person (normalized)" = emmean),
    mapping = aes(ymin = lower.CL, ymax = upper.CL)
  ) +  
  geom_point(
    data = emms.m1b3.tab |> rename("Dyadic TSD Attractive Person (normalized)" = emmean),
    position = position_dodge(0.1), size = 3
  ) +  
  stat_pvalue_manual(t.m1b3, label = "p.signif", y.position = c(0.6, 0.7), tip.length = 0) +  
  guides(color = "none") +  
  theme_tq()  

# Combine the three plots into a single figure
p1b <- ggarrange(h1b1, h1b2 + labs(y = NULL), h1b3 + labs(y = NULL),  
  ncol = 3, labels = "auto", widths = c(1, 1, 1.5)  # Adjust widths for better alignment
)

# Display the final figure
p1b
```

### Hypothesis 1c: Dyadic TSD (Partner) {#hypothesis1c}

#### Model the effects of relationship type and gender on Dyadic TSD: Partner

We fitted models with both the original (proportion; `m1c_prop`) and transformed (normalized; `m1c_norm`) TSD scores, and performed posterior predictive checks (PPCs). As shown elsewhere [e.g., @gabryVisualizationBayesianWorkflow2019], if simulated data from one model are more similar to the observed outcome, that model is likely to be preferred.

```{r}
# Set contrast options for sum coding (useful for ANOVA-like interpretation)
options(contrasts = c("contr.sum", "contr.poly"))  

# Fit a linear model using the original proportion-based Dyadic TSD (Partner) scores
m1c_prop <- lm(
  `Dyadic TSD Partner (proportion)` ~ Gender * Relationship, 
  data = dat_m1
)

# Fit a linear model using the normalized Dyadic TSD (Partner) scores
m1c_norm <- lm(
  `Dyadic TSD Partner (normalized)` ~ Gender * Relationship, 
  data = dat_m1
)
```

##### Figure \@ref(fig:ppc-m1c): Posterior predictive checks (PPCs) for Hypothesis 1c. 

PPCs were performed using the `check_model` function from the `performance` package [@ludecke2021], and reported in Fig. \@ref(fig:ppc-m1c). Simulated data from the normalized Solitary TSD model (Fig. \@ref(fig:ppc-m1c)b) are more similar to the observed outcome, so this model is preferred.

```{r ppc-m1c, message = FALSE, fig.height = 4, fig.cap = "Posterior predictive check. **(a)** Original (proportion) Solitary TSD; **(b)** Transformed (normalized) Solitary TSD. In both panels, red lines represent the observed data, and thin black lines represent 50 iterations of simulated data from each model. "}
# Perform posterior predictive checks (PPC) and arrange them into a single figure
ppc_m1c <- ggarrange(
  # PPC plot for the original (proportion) Dyadic TSD: Partner model
  plot(
    check_model(m1c_prop, panel = FALSE, check = "pp_check")$PP_CHECK,  
    colors = c("red", "grey30")  # Red for observed data, grey for simulated data
  ) +  
    labs(title = NULL, subtitle = NULL) +  
    theme_tq() +  
    facet_wrap(~1, labeller = as_labeller(c(
      "1" = "Original (proportion) Dyadic TSD: Partner"
    ))),  
  # PPC plot for the transformed (normalized) Dyadic TSD: Partner model
  plot(
    check_model(m1c_norm, panel = FALSE, check = "pp_check")$PP_CHECK,  
    colors = c("red", "grey30")  
  ) +  
    labs(title = NULL, subtitle = NULL) +  
    theme_tq() +  
    facet_wrap(~1, labeller = as_labeller(c(
      "1" = "Transformed (normalized) Dyadic TSD: Partner"
    ))),  
  labels = "auto",  # Automatically label subplots (a, b)
  common.legend = TRUE, legend = "bottom"  # Use a common legend at the bottom
)

# Display the final PPC figure
ppc_m1c
```

#### Table \@ref(tab:tab-m1c). ANOVA-type table for the interaction between `Relationship type`, and `Gender`

This tables summarizes the results of the model.

```{r tab-m1c}
# Generate an ANOVA table summarizing the effects of Relationship Type and Gender on  
# Dyadic TSD Partner
anova.sig.lm(
  model = m1c_norm,  
  custom_caption = "Effects of relationship type and gender on Dyadic TSD Partner"
)
```

#### *Post-hoc* comparisons

Because the main effects of gender and relationship type, but not their interaction, are significant, we explored these effects using estimated marginal means.

##### Table \@ref(tab:tab-m1c-emm1). Estimated marginal means and contrasts between participants' gender.

Table of estimated marginal means and contrasts between genders. All estimated marginal means and contrasts were calculated using the `emmeans` function from the `emmeans` package [@emmeanscit].

```{r tab-m1c-emm1, message = FALSE}
# Compute estimated marginal means (EMMs) for Gender from the model
emms.m1c1 <- emmeans(m1c_norm, ~Gender)  

# Convert EMM results to a tibble for easier manipulation
emms.m1c1.tab <- tibble(data.frame(emms.m1c1))  

# Compute post-hoc contrasts and format p-values
t.m1c1 <- contr.stars(emms.m1c1) |>  
  mutate(p.value = pval.lev(p.value))  # Format p-values for LaTeX

# Merge EMM and contrast results, clean column names, and format output
merge(emms.m1c1.tab, t.m1c1, by = 0, all = TRUE) |>  
  select(-c(1, 15)) |>  # Remove unnecessary columns
  unite(Contrast, group1, group2, sep = " - ") |>  # Create contrast labels
  mutate_at("Contrast", str_replace_all, "NA - NA", " ") |>  # Replace missing contrasts
  # Create formatted table
  kable(
    digits = 2, booktabs = TRUE, align = c("l", rep("c", 5), "l", rep("c", 5)), linesep = "",
    caption = "Estimated marginal means and contrasts between participants' gender", 
    escape = FALSE,
    col.names = c(
      "Gender", "EMM", "$SE$", "$df$", "$2.5\\% CI$", "$97.5\\% CI$",  
      "Contrast", "Difference", "$SE$", "$df$", "$t$", "$p$"
    )
  ) |>  
  # Add a header separating EMMs and contrasts
  add_header_above(c(" " = 6, "Contrasts" = 6)) |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  # Add footnote explaining significance formatting
  footnote(
    general = "Significant effects are in bold.", threeparttable = TRUE,  
    footnote_as_chunk = TRUE, escape = FALSE
  )
```

##### Table \@ref(tab:tab-m1c-emm2). Estimated marginal means and contrasts between relationship status.

Table of estimated marginal means and contrasts between relationship status. All estimated marginal means and contrasts were calculated using the `emmeans` function from the `emmeans` package [@emmeanscit].

```{r tab-m1c-emm2, message = FALSE}
# Compute estimated marginal means (EMMs) for Relationship Status from the model
emms.m1c2 <- emmeans(m1c_norm, ~Relationship)  

# Convert EMM results to a tibble for easier manipulation
emms.m1c2.tab <- tibble(data.frame(emms.m1c2))  

# Compute post-hoc contrasts and format p-values
t.m1c2 <- contr.stars(emms.m1c2) |>  
  mutate(p.value = pval.lev(p.value))  # Format p-values for LaTeX

# Merge EMM and contrast results, clean column names, and format output
merge(emms.m1c2.tab, t.m1c2, by = 0, all = TRUE) |>  
  select(-c(1, 15)) |>  # Remove unnecessary columns
  unite(Contrast, group1, group2, sep = " - ") |>  # Create contrast labels
  mutate_at("Contrast", str_replace_all, "NA - NA", " ") |>  # Replace missing contrasts
  # Create formatted table
  kable(
    digits = 2, booktabs = TRUE, align = c("l", rep("c", 5), "l", rep("c", 5)), linesep = "",
    caption = "Estimated marginal means and contrasts between relationship status", 
    escape = FALSE,
    col.names = c(
      "Relationship type", "EMM", "$SE$", "$df$", "$2.5\\% CI$", "$97.5\\% CI$",  
      "Contrast", "Difference", "$SE$", "$df$", "$t$", "$p$"
    )
  ) |>  
  # Add a header separating EMMs and contrasts
  add_header_above(c(" " = 6, "Contrasts" = 6)) |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  # Add footnote explaining significance formatting
  footnote(
    general = "Significant effects are in bold.", threeparttable = TRUE,  
    footnote_as_chunk = TRUE, escape = FALSE
  )
```

##### Table \@ref(tab:tab-m1c-emm3). Estimated marginal means and contrasts between gender by relationship status.

Table of estimated marginal means and contrasts between gender by relationship status. All estimated marginal means and contrasts were calculated using the `emmeans` function from the `emmeans` package [@emmeanscit].

```{r tab-m1c-emm3, message = FALSE}
# Compute estimated marginal means (EMMs) for Gender within each Relationship Status
emms.m1c3 <- emmeans(m1c_norm, ~ Gender | Relationship)  

# Convert EMM results to a tibble for easier manipulation
emms.m1c3.tab <- tibble(data.frame(emms.m1c3))  

# Compute post-hoc contrasts and format p-values
t.m1c3 <- contr.stars(emms.m1c3) |>  
  mutate(p.value = pval.lev(p.value))  # Format p-values for LaTeX

# Insert NA rows to maintain table structure for grouped relationship status display
t.m1c3.f <- t.m1c3 |>  
  insertRows(2, new = NA) |>  # Insert empty row after first contrast
  insertRows(4, new = NA)  # Insert empty row after second contrast

# Merge EMM and contrast results, clean column names, and format output
merge(emms.m1c3.tab, t.m1c3.f, by = 0, all = TRUE) |>  
  select(-c(1, 3, 11, 17)) |>  # Remove unnecessary columns
  drop_na(Gender) |>  # Ensure Gender column is complete
  unite(Contrast, group1, group2, sep = " - ") |>  # Create contrast labels
  mutate_at("Contrast", str_replace_all, "NA - NA", "") |>  # Replace missing contrasts
  # Create formatted table
  kable(
    digits = 2, booktabs = TRUE, align = c("l", "l", rep("c", 5), "l", rep("c", 5)), linesep = "",
    caption = "Estimated marginal means and contrasts between gender by relationship status", 
    escape = FALSE,
    col.names = c(
      "Gender", "EMM", "$SE$", "$df$", "$2.5\\% CI$", "$97.5\\% CI$",  
      "Contrast", "Difference", "$SE$", "$df$", "$t$", "$p$"
    )
  ) |>  
  # Add grouped row labels for Relationship Status
  pack_rows("Relationship status: Stable", start_row = 1, end_row = 2,  
    bold = FALSE, background = "lightgray") |>  
  pack_rows("Relationship status: Single", start_row = 3, end_row = 4,  
    bold = FALSE, background = "lightgray") |>  
  # Add a header separating EMMs and contrasts
  add_header_above(c(" " = 6, "Contrasts" = 6)) |>  
  # Apply LaTeX styling for table positioning
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>  
  # Add footnote explaining significance formatting
  footnote(
    general = "Significant effects are in bold.", threeparttable = TRUE,  
    footnote_as_chunk = TRUE, escape = FALSE
  )
```

#### Figure \@ref(fig:fig-h1c). Effects of gender and relationship type on Dyadic TSD Partner

This figure summarizes the results of hypothesis 1c.

```{r fig-h1c, results = "hold", fig.height = 4, fig.cap = "Effects of gender and relationship type on Dyadic TSD Partner. Dyadic TSD Partner was transformed using ordered quantile normalization [@petersonOrderedQuantileNormalization2020a]. **(a)** Simple comparison between sexual desire by gender (for detailed results, see Table \\@ref(tab:tab-m1c-emm1)); **(b)** Simple comparison between relationship status levels (for detailed results, see Table \\@ref(tab:tab-m1c-emm2)); **(c)** Interaction between relationship type and relationship status (see Table \\@ref(tab:tab-m1c); for detailed results, see Table \\@ref(tab:tab-m1c-emm3)). Dots and bars represent estimated marginal means and 95% CI. In all cases, significant effects are represented with lines and stars: \\**p* < 0.05, \\*\\**p* < 0.01, \\*\\*\\**p* < 0.001, \\*\\*\\*\\**p* < 0.0001.", warning = FALSE, message = FALSE}
# Plot (a): Main effect of Gender on Dyadic TSD Partner
h1c1 <- ggplot(dat_m1, aes(
  x = Gender, y = `Dyadic TSD Partner (normalized)`, color = Gender
)) +  
  scale_color_manual(values = color.Gender) +  
  scale_fill_manual(values = color.Gender) +  
  geom_linerange(
    data = emms.m1c1.tab |> rename("Dyadic TSD Partner (normalized)" = emmean),
    mapping = aes(ymin = lower.CL, ymax = upper.CL)
  ) +  
  geom_point(
    data = emms.m1c1.tab |> rename("Dyadic TSD Partner (normalized)" = emmean),
    position = position_dodge(0.1), size = 3
  ) +  
  stat_pvalue_manual(t.m1c1, label = "p.signif", y.position = 0.4, tip.length = 0) +  
  guides(color = "none") +  
  theme_tq()  

# Plot (b): Main effect of Relationship on Dyadic TSD Partner
h1c2 <- ggplot(dat_m1, aes(
  x = Relationship, y = `Dyadic TSD Partner (normalized)`, color = Relationship
)) +  
  scale_color_manual(values = color.Relationship) +  
  scale_fill_manual(values = color.Relationship) +  
  geom_linerange(
    data = emms.m1c2.tab |> rename("Dyadic TSD Partner (normalized)" = emmean),
    mapping = aes(ymin = lower.CL, ymax = upper.CL)
  ) +  
  geom_point(
    data = emms.m1c2.tab |> rename("Dyadic TSD Partner (normalized)" = emmean),
    position = position_dodge(0.1), size = 3
  ) +  
  stat_pvalue_manual(t.m1c2, label = "p.signif", y.position = 0.5, tip.length = 0) +  
  guides(color = "none") +  
  theme_tq()  

# Plot (c): Gender × Relationship Interaction on Dyadic TSD Partner
h1c3 <- ggplot(dat_m1, aes(
  x = Gender, y = `Dyadic TSD Partner (normalized)`, color = Gender
)) +  
  scale_color_manual(values = color.Gender) +  
  scale_fill_manual(values = color.Gender) +  
  facet_wrap(~Relationship) +  
  geom_linerange(
    data = emms.m1c3.tab |> rename("Dyadic TSD Partner (normalized)" = emmean),
    mapping = aes(ymin = lower.CL, ymax = upper.CL)
  ) +  
  geom_point(
    data = emms.m1c3.tab |> rename("Dyadic TSD Partner (normalized)" = emmean),
    position = position_dodge(0.1), size = 3
  ) +  
  stat_pvalue_manual(t.m1c3, label = "p.signif", y.position = c(0.8, 0.2), tip.length = 0) +  
  guides(color = "none") +  
  theme_tq()  

# Combine the three plots into a single figure
p1c <- ggarrange(h1c1, h1c2 + labs(y = NULL), h1c3 + labs(y = NULL),  
  ncol = 3, labels = "auto", widths = c(1, 1, 1.5)  # Adjust widths for better alignment
)

# Display the final figure
p1c
```

## Data filtering for hypotheses 2 and 3. {#datfil2and3} 

To avoid over-complicating the models, first we tested whether the effects of stimuli on sexual arousal were stronger depending on the content of the stimuli (erotic versus non-erotic). This was, in fact, the case.

### Table \@ref(tab:tab-m-stimuli-content). ANOVA-type table for the effects of stimuli content, gender and stimuli content on Subjective sexual arousal

We fitted a linear mixed model with Gender, Stimuli sex, Stimuli content, and their interactions, as fixed effects for Subjective sexual arousal and including, as random effects, random intercepts per stimulus, as well as random intercepts and slopes for the effect of stimuli content.

```{r tab-m-stimuli-content, message = FALSE, warning = FALSE, cache = TRUE}
m_stim_cont <- lmer(
  `Subjective sexual arousal` ~
    Gender * `Stimuli sex` * `Stimuli content` +
    (1 | `Stimuli code`) +
    (1 + `Stimuli content` * `Stimuli sex` | Participant),
  data = dat,
  control = lmerControl(optimizer = "bobyqa")
)

anova.sig.lmer(
  model = m_stim_cont,
  custom_caption = "Effects of relationship type and gender
               on Dyadic TSD Partner"
)
```

The effects of stimuli on sexual arousal were stronger for erotic compared to non-erotic stimuli; to illustrate this, we compared the (within-subject) difference in reported sexual arousal between stimuli sexes, for women and men. This difference was larger when viewing erotic than non-erotic stimuli in both women (erotic: 0.77, non-erotic: 0.57) but especially in men (erotic: 2.75, non-erotic: 1.60; see Table \@ref(tab:tab-stim-cont-emms) and Fig. \@ref(fig:fig-m-stimuli-content)). Considering this, we tested all predictions of hypotheses 2 and 3 only on responses to erotic stimuli.

### Table \@ref(tab:tab-stim-cont-emms). Estimated marginal means and contrasts between subjective sexual arousal depending on stimuli sex, by stimuli content and participant gender.

Table of estimated marginal means and contrasts between between subjective sexual arousal depending on stimuli sex, by stimuli content and participant gender. All estimated marginal means and contrasts were calculated using the `emmeans` function from the `emmeans` package [@emmeanscit].

```{r tab-stim-cont-emms, message = FALSE, warning = FALSE, cache = TRUE}
emms.stim_cont <- emmeans(m_stim_cont, pairwise ~ `Stimuli sex` | `Stimuli content` + Gender,
  adjust = "bonferroni",
  lmer.df = "satterthwaite"
)

emms.stim_cont.tab <- tibble(data.frame(emms.stim_cont$emmeans)) |>
  rename(
    "Subjective sexual arousal" = emmean,
    "Stimuli content" = Stimuli.content,
    "Stimuli sex" = Stimuli.sex
  )

t.stim_cont <- contr.stars(emms.stim_cont) |>
  mutate(p.value = pval.lev(p.value))

t.stim_cont.f <- t.stim_cont |>
  insertRows(2, new = NA) |>
  insertRows(4, new = NA) |>
  insertRows(6, new = NA) |>
  insertRows(8, new = NA)

merge(emms.stim_cont.tab, t.stim_cont.f, by = 0, all = TRUE) |>
  select(-c(1, 3, 4, 12, 13, 19)) |>
  drop_na("Stimuli sex") |>
  unite(Contrast, group1, group2, sep = " - ") |>
  mutate_at("Contrast", str_replace_all, "NA - NA", " ") |>
  mutate(across(c(df.x, df.y), as.character)) |>
  mutate(across(c(df.x, df.y), str_replace_all, "Inf", "$\\\\infty$")) |>
  kable(
    digits = 2,
    booktabs = TRUE,
    align = c("l", "l", rep("c", 5), "l", rep("c", 5)),
    linesep = "",
    caption = "Estimated marginal means for the three dimensions of sexual desire by
        relationship status",
    col.names = c(
      "Stimuli sex",
      "EMM",
      "$SE$",
      "$df$",
      "$2.5\\% CI$",
      "$97.5\\% CI$",
      "Contrast",
      "Difference",
      "$SE$",
      "$df$",
      "$z$",
      "$p$"
    ),
    escape = FALSE
  ) |>
  pack_rows(
    group_label = "Gender: Women - Stimuli content: Erotic",
    start_row = 1,
    end_row = 2,
    bold = FALSE,
    background = "lightgray"
  ) |>
  pack_rows(
    group_label = "Gender: Women - Stimuli content: Non-erotic",
    start_row = 3,
    end_row = 4,
    bold = FALSE,
    background = "lightgray"
  ) |>
  pack_rows(
    group_label = "Gender: Men - Stimuli content: Erotic",
    start_row = 5,
    end_row = 6,
    bold = FALSE,
    background = "lightgray"
  ) |>
  pack_rows(
    group_label = "Gender: Men - Stimuli content: Non-erotic",
    start_row = 7,
    end_row = 8,
    bold = FALSE,
    background = "lightgray"
  ) |>
  add_header_above(c(" " = 6, "Contrasts" = 6)) |>
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>
  footnote(
    general = "EMM = estimated marginal mean.
           Degrees of freedom ($df$) are asymptotic.
           Bonferroni adjustment was used.",
    threeparttable = TRUE,
    footnote_as_chunk = TRUE,
    escape = FALSE
  )
```

### Figure \@ref(fig:fig-m-stimuli-content). Effects of stimuli content (erotic, non-erotic) on subjective sexual arousal

This figure summarizes the results of the model to determine whether the effects of stimuli on sexual arousal were stronger depending on the content of the stimuli (erotic versus non-erotic).

```{r fig-m-stimuli-content, results = "hold", fig.height = 4, fig.width = 8, fig.cap = "Effects of stimuli content (erotic, non-erotic) on subjective sexual arousal for women's (left panel) and men's (right panel) scores of male and female stimuli (see Table \\@ref(tab:tab-m-stimuli-content); for detailed results, see Table \\@ref(tab:tab-stim-cont-emms)). Dots and bars represent estimated marginal means and 95% CI. Vertical lines with arrow heads represent the (absolute) difference in reported subjective sexual arousal for male and femnale stimuli, by stimuli content and gender. In all cases, significant effects are represented with lines and stars: \\**p* < 0.05, \\*\\**p* < 0.01, \\*\\*\\**p* < 0.001, \\*\\*\\*\\**p* < 0.0001.", warning = FALSE, message = FALSE}
# Prepare data for vertical comparison lines between Male and Female
diff_data <- emms.stim_cont.tab |>
  select(`Stimuli sex`, Gender, `Stimuli content`, `Subjective sexual arousal`) |>
  pivot_wider(names_from = `Stimuli sex`, values_from = `Subjective sexual arousal`) |>
  mutate(
    ymin = Male, # Start of line at Male's mean arousal
    ymax = Female # End of line at Female's mean arousal
  ) |>
  mutate(
    # Define custom x positions slightly offset for better readability
    x_pos = rep(c(
      as.numeric(as.factor(`Stimuli content`[1])) - 0.25,
      as.numeric(as.factor(`Stimuli content`[2])) + 0.25
    ), 2)
  )

# Create the plot
ggplot(emms.stim_cont.tab, aes(
  x = `Stimuli sex`, y = `Subjective sexual arousal`,
  color = `Stimuli content`
)) +
  # Separate plots for each Gender
  facet_wrap(~Gender) +
  # Set custom colors for Stimuli content
  scale_color_manual(values = color.Content) +
  scale_fill_manual(values = color.Content) +
  # Add confidence interval ranges
  geom_linerange(
    data = emms.stim_cont.tab,
    mapping = aes(ymin = asymp.LCL, ymax = asymp.UCL),
    position = position_dodge(0.5)
  ) +
  # Add individual data points with position dodge to avoid overlap
  geom_point(
    data = emms.stim_cont.tab,
    position = position_dodge(0.5),
    size = 3
  ) +
  # Add statistical significance annotations
  stat_pvalue_manual(t.stim_cont,
    label = "p.signif",
    y.position = c(2.7, 3, 4.2, 3), # Adjusted y positions for clarity
    tip.length = 0,
    color = "Stimuli content",
    position = position_dodge(0.5)
  ) +
  # Add vertical dotted lines WITHOUT arrows
  geom_segment(
    data = diff_data,
    aes(
      x = x_pos, xend = x_pos,
      y = ymin, yend = ymax,
      color = `Stimuli content`
    ),
    linewidth = 0.5,
    linetype = "dotted"
  ) + # Dotted lines
  # Add SOLID arrows separately, with NO line
  geom_segment(
    data = diff_data,
    aes(
      x = x_pos, xend = x_pos,
      y = ymin, yend = ymax,
      color = `Stimuli content`
    ),
    linetype = "solid", # Make sure arrows are solid
    linewidth = 0, # Hide the line itself
    arrow = arrow(length = unit(0.3, "cm"), type = "closed", ends = "both")
  ) +
  # Rotated & Centered Difference Labels on the vertical lines
  geom_text(
    data = diff_data,
    aes(
      x = x_pos - 0.06, y = (ymin + ymax) / 2,
      label = abs(round(ymax - ymin, 2)),
      color = `Stimuli content`
    ),
    angle = 90, # Rotate text vertically
    hjust = 0.5, # Center horizontally
    vjust = 0.5, # Center vertically on the line
    size = 2.5
  ) +
  theme_tq()
```

## Hypothesis 2: The association between trait sexual desire (TSD) and subjective sexual arousal (SSA) will vary by TSD dimension, with these associations being gender-specific in men and gender-non-specific in women. {#hyp2}

We tested whether the relationship between SSA and TSD varies across the three dimensions of TSD and whether these associations differ between men and women. Specifically, we examined:

* **H2a**: A significant association between solitary TSD and SSA toward erotic stimuli (section \@ref(hyp2a))
* **H2b**: A significant association between dyadic TSD toward an attractive person and SSA toward erotic stimuli.
* **H2c**: No significant association between dyadic TSD toward a partner and SSA toward erotic stimuli.

To examine this hypothesis, we modeled the effects of each of the three TSD dimension scores, gender, stimulus sex, and their interactions, on SSA. We included random intercepts for each stimulus, as well as random intercepts and slopes between stimuli sex for each participant. 

### Modeling Approach

Since SSA is an ordinal variable with seven ordered levels, we fitted the models using three different approaches to ensure the robustness of our results:

1. Cumulative Link Mixed Model (CLMM), using the `clmm` function from the package `ordinal` [@ordinalcit]
2. Generalized Mixed Model (GLMM) with a Poisson family, using the `glmer` function from the package `lme4` [@lme4cit]
3. Linear mixed model (LMM), using the `lmer` function from the package `lmerTest` [@lmertestcit]

The results across these models were largely consistent, indicating robustness in our findings. For clarity and interpretability, we primarily base our inferences on the LMM, as it provides the most straightforward interpretation and has a wider range of available functions in R for extracting model information.

### Data

We created a new dataset by selecting only responses to erotic stimuli, renaming key variables to remove spaces for compatibility with certain functions, and converting relevant variables to factors. Specifically, the Gender and Stimuli sex variables are transformed into factors, and a factor version of Subjective sexual arousal is created for use in the CLMM model. 

```{r message = FALSE, warning = FALSE}
# Filter dataset to include only responses to erotic stimuli
dat_m2 <- dat |>
  filter(`Stimuli content` == "Erotic") |> # Select only erotic stimuli responses
  # Rename variables to remove spaces (improves function compatibility)
  rename(
    Subjective.sexual.arousal = `Subjective sexual arousal`,
    Solitary.TSD = `Solitary sexual desire`,
    Dyadic.TSD.Attractive.Person = `Dyadic sexual desire (Attractive person)`,
    Dyadic.TSD.Partner = `Dyadic sexual desire (Partner)`,
    Stimuli.sex = `Stimuli sex`,
    Stimuli.code = `Stimuli code`
  ) |>
  # Convert categorical variables to factors
  mutate(
    Gender = as.factor(Gender),
    Stimuli.sex = as.factor(Stimuli.sex),
    # Create a factor version of SSA for use in the CLMM model
    Subjective.sexual.arousal.factor = as.factor(Subjective.sexual.arousal)
  )
```

### Hypothesis 2a: Solitary TSD {#hyp2a}

#### Model Robustness: Examining the Effects of Solitary TSD on SSA Across Gender and Stimuli Sex

To assess the robustness of our findings, we fitted three different models examining how Solitary TSD predicts SSA, considering variations by gender and stimuli sex:

1. Cumulative Link Mixed Model (CLMM) – `m2a_clmm` (for ordinal outcomes, using a probit link).
2. Generalized Linear Mixed Model (GLMM) with Poisson family – `m2a_poisson` (treating SSA as a count variable).
3. Linear Mixed Model (LMM) – `m2a_lmer` (treating SSA as a continuous variable).

```{r cache = TRUE, message = FALSE, warning = FALSE}
# Cumulative Link Mixed Model (CLMM) - Ordinal model with probit link
m2a_clmm <- clmm(
  Subjective.sexual.arousal.factor ~  Solitary.TSD * Gender * Stimuli.sex +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 + Stimuli.sex | Participant), # Random intercept & slope for Stimuli sex
  data = dat_m2,
  link = "probit",
  control = list(method = "nlminb") # Use 'nlminb' optimizer for better convergence
)

# Generalized Linear Mixed Model (GLMM) - Poisson regression for count data
m2a_poisson <- glmer(
  Subjective.sexual.arousal ~  Solitary.TSD * Gender * Stimuli.sex +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 + Stimuli.sex | Participant), # Random intercept & slope for Stimuli sex
  data = dat_m2,
  family = poisson # Poisson distribution for count data
)

# Linear Mixed Model (LMM) - Continuous approximation
m2a_lmer <- lmer(
  Subjective.sexual.arousal ~  Solitary.TSD * Gender * Stimuli.sex +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 + Stimuli.sex | Participant), # Random intercept & slope for Stimuli sex
  data = dat_m2,
  control = lmerControl(optimizer = "bobyqa") # Use 'bobyqa' optimizer for stability
)
```

##### Table \@ref(tab:tab-robu-m2a). ANOVA-type table of fixed effects (main effects and interactions) across the three fitted models

As shown in the table below, the pattern of significant effects remains consistent across all three models, except for the main effect of gender, which is not significant in the CLMM.

```{r tab-robu-m2a, message = FALSE}
anova.comp(CLMMmod = m2a_clmm, GLMERmod = m2a_poisson, LMERmod = m2a_lmer, hypothesis = "2a")
```

##### Figure \@ref(fig:preds-m2a): Model-based predictions for Hypothesis 2a.

This figure presents model-based predictions of subjective sexual arousal as a function of  Solitary TSD, across different stimulus sexes and participant genders. The three subplots correspond to the three statistical models used for analysis: (a) Cumulative Link Mixed Model (CLMM), (b) Generalized Linear Mixed Model (GLMM, Poisson), and (c) Linear Mixed Model (LMM). Shaded areas represent 95% confidence intervals.

```{r preds-m2a, cache = TRUE, message = FALSE, fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of  Solitary TSD, modeled using three statistical approaches: **(a)** Cumulative Link Mixed Model (CLMM); **(b)** Generalized Linear Mixed Model (GLMM) with a Poisson family; **(c)** Linear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The models include participant gender and stimulus sex as key factors."}
# CLMM Predictions
p_m2a_clmm <- emmeans(m2a_clmm, ~  Solitary.TSD | Gender * Stimuli.sex,
  at = list( Solitary.TSD = seq(0, 31, length.out = 100)),
  mode = "mean.class"
) |> # Compute predicted mean response categories
  as.data.frame() |> # Convert to dataframe for ggplot
  ggplot(aes(
    x =  Solitary.TSD, y = mean.class,
    color = Stimuli.sex, fill = Stimuli.sex
  )) +
  geom_line(size = 1) + # Add predicted response line
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Stimuli.sex),
    alpha = 0.2, color = NA
  ) + # Add confidence interval as shaded ribbon
  scale_color_manual(values = color.StimuliSex) + # Apply custom colors
  scale_fill_manual(values = color.StimuliSex) +
  facet_wrap(~Gender, ncol = 1) + # Create separate plots for each gender
  labs(
    y = "Predicted Subjective Sexual Arousal", 
    x = "Solitary TSD",
    title = "CLMM",
    color = "Stimuli Sex", fill = "Stimuli Sex"
  ) +
  theme_tq() + # Apply custom theme
  theme(legend.position = "bottom") +
  ylim(c(0.3, 5.3)) # Set Y-axis limits

# Poisson GLMM Predictions
p_m2a_poisson <- emmeans(m2a_poisson, ~  Solitary.TSD | Gender * Stimuli.sex,
  at = list( Solitary.TSD = seq(0, 31, length.out = 100)),
  type = "response"
) |> # Compute response-scale predictions
  as.data.frame() |>
  ggplot(aes(
    x =  Solitary.TSD, y = rate,
    color = Stimuli.sex, fill = Stimuli.sex
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Stimuli.sex),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.StimuliSex) +
  scale_fill_manual(values = color.StimuliSex) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Solitary TSD",
    title = "GLMER (Poisson)",
    color = "Stimuli Sex", fill = "Stimuli Sex"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 5.3))

# LMM Predictions
p_m2a_lmer <- emmeans(m2a_lmer, ~  Solitary.TSD | Gender * Stimuli.sex,
  at = list( Solitary.TSD = seq(0, 31, length.out = 100)),
  type = "response"
) |>
  as.data.frame() |>
  ggplot(aes(
    x =  Solitary.TSD, y = emmean,
    color = Stimuli.sex, fill = Stimuli.sex
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Stimuli.sex),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.StimuliSex) +
  scale_fill_manual(values = color.StimuliSex) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Solitary TSD",
    title = "LMM",
    color = "Stimuli Sex", fill = "Stimuli Sex"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 5.3))

# Arrange Plots into a Single Figure
p_robu_m2a <- ggarrange(p_m2a_clmm, p_m2a_poisson, p_m2a_lmer, # Combine plots side by side
  common.legend = TRUE, # Share legend across plots
  labels = "auto", # Automatically label subfigures (a, b, c)
  legend = "bottom",
  nrow = 1
) # Arrange in a single row

# Display the combined figure
p_robu_m2a
```

#### Final Model: Effects of Solitary TSD on SSA Across Gender and Stimuli Sex

Given the aparent robustness of most results across models (CLMM, GLMER and LMM; Table \@ref(tab:tab-robu-m2a), Fig. \@ref(fig:preds-m2a)), we test the predictions of the hypothesis from the LMM (`m2a_lmer`).

##### Table \@ref(tab:tab-m2a). ANOVA-type table for the interaction between `Relationship type`, and `Gender`

This tables summarizes the results of the model.

```{r tab-m2a}
anova.sig.lmer(model = m2a_lmer, custom_caption = "Effects of Solitary TSD on SSA Across 
              Gender and Stimuli Sex")
```

##### *Post-hoc* tests

To test the hypothesis, which predicted that there would be different relationship between SSA and solitary TSD, and that this association differ between men and women depending on the sex of stimuli, we used simple slope analysis.

Slope for solitary TSD on SSA by stimuli sex and participant gender

```{r cache = TRUE, warning = FALSE, message = FALSE}
slop.m2a_lmer <- sim_slopes(m2a_lmer, 
                            pred =  Solitary.TSD, 
                            modx = Stimuli.sex, 
                            mod2 = Gender,
                            confint = TRUE)

slop.m2a_lmer.tab <- bind_rows(slop.m2a_lmer$slopes[[1]] |> 
                                 mutate(Gender = "Women"),
                               slop.m2a_lmer$slopes[[2]] |> 
                                 mutate(Gender = "Men")) |>
  mutate(Gender = recode_factor(Gender,
    Femenino = "Women",
    Masculino = "Men"
  )) |> 
  select(8, 1:2, 4:7) |>
  mutate(across(3:7, as.numeric)) |>
  mutate(across(3:6, round, 2)) |>
  mutate(sig = pval.stars(p)) |>
  rename("Stimuli.sex" = "Value of Stimuli.sex") |>
  rename(Coefficient = Est.)

slop.m2a_lmer.tab[,-c(1,8)] |> 
  mutate(p = pval.lev(p)) |> 
  kable(booktabs = TRUE,
        align = c("l", rep("c", 5)),
        caption = "Slope for Solitary TSD on 
        Subjective sexual arousal by stimuli sex and gender",
        linesep = "",
        col.names = c("Stimuli sex",
                      "$B$",
                      "$2.5\\% CI$",
                      "$97.5\\% CI$",
                      "$t$",
                      "$p$"),
        escape = FALSE) |> 
  kable_styling(latex_options = c("HOLD_position")) |>
  pack_rows(
      group_label = "Gender: Women",
      start_row = 1,
      end_row = 2,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  pack_rows(
      group_label =  "Gender: Men",
      start_row = 3,
      end_row = 4,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  footnote(general = "$B$ are unstandardized coefficient.
           No intercept is reported as continuous predictors were centered
           and are dependent on this specific sample.",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE,
           escape = FALSE)
```

#### Figure \@ref(fig:fig-h2a). Subjective sexual arousal to erotic stimuli: Main effects and interactions

This figure summarizes the results of hypothesis 2a. 

```{r fig-h2a, results = "hold", fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of Solitary TSD, modeled using aLinear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The model include participant gender and stimuli sex as key factors.", warning = FALSE, message = FALSE}
# Figure interaction between Stimuli sex and gender
p_m2a.fin <- p_m2a_lmer +
  labs(title = "",
       y = "Predicted Subjective Sexual Arousal") +
  facet_wrap(~ Gender, ncol = 2) +
  # Add text labels, nudging each one slightly down
  geom_text(data = slop.m2a_lmer.tab |> 
              mutate( Solitary.TSD = 2),
            mapping = aes(x = min( Solitary.TSD), y = Inf, 
                          label = paste("B = ", Coefficient, 
                                        ", IC 95%[", `2.5%`, ", ", `97.5%`, 
                                        "], p", 
                                        ifelse(grepl("<", pe2.lev(p)), pe2.lev(p), 
                                               paste0(" = ", pe2.lev(p))),
                                        ifelse(is.na(sig), "", sig)),
                          vjust = 2 + as.numeric(as.factor(Stimuli.sex))*2),  # Stacks labels
            hjust = -0.1,  # Aligns to the left
            #size = 3,
            show.legend = FALSE) +
  theme(legend.position = "bottom")
p_m2a.fin
```

### Hypothesis 2b: Dyadic TSD Attractive Person {#hyp2b}

#### Model Robustness: Examining the Effects of Dyadic TSD Attractive Person on SSA Across Gender and Stimuli Sex

To assess the robustness of our findings, we fitted three different models examining how Dyadic TSD Attractive Person predicts SSA, considering variations by gender and stimuli sex:

1. Cumulative Link Mixed Model (CLMM) – `m2b_clmm` (for ordinal outcomes, using a probit link).
2. Generalized Linear Mixed Model (GLMM) with Poisson family – `m2b_poisson` (treating SSA as a count variable).
3. Linear Mixed Model (LMM) – `m2b_lmer` (treating SSA as a continuous variable).

```{r cache = TRUE, message = FALSE, warning = FALSE}
# Cumulative Link Mixed Model (CLMM) - Ordinal model with probit link
m2b_clmm <- clmm(
  Subjective.sexual.arousal.factor ~ Dyadic.TSD.Attractive.Person * Gender * Stimuli.sex +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 + Stimuli.sex | Participant), # Random intercept & slope for Stimuli sex
  data = dat_m2,
  link = "probit",
  control = list(method = "nlminb") # Use 'nlminb' optimizer for better convergence
)

# Generalized Linear Mixed Model (GLMM) - Poisson regression for count data
m2b_poisson <- glmer(
  Subjective.sexual.arousal ~ Dyadic.TSD.Attractive.Person * Gender * Stimuli.sex +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 + Stimuli.sex | Participant), # Random intercept & slope for Stimuli sex
  data = dat_m2,
  family = poisson # Poisson distribution for count data
)

# Linear Mixed Model (LMM) - Continuous approximation
m2b_lmer <- lmer(
  Subjective.sexual.arousal ~ Dyadic.TSD.Attractive.Person * Gender * Stimuli.sex +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 + Stimuli.sex | Participant), # Random intercept & slope for Stimuli sex
  data = dat_m2,
  control = lmerControl(optimizer = "bobyqa") # Use 'bobyqa' optimizer for stability
)
```

##### Table \@ref(tab:tab-robu-m2b). ANOVA-type table of fixed effects (main effects and interactions) across the three fitted models

As shown in the table below, the pattern of significant effects remains consistent across all three models, except for the main effect of gender, which is not significant in the CLMM.

```{r tab-robu-m2b, message = FALSE}
anova.comp(CLMMmod = m2b_clmm, GLMERmod = m2b_poisson, LMERmod = m2b_lmer, hypothesis = "2b")
```

##### Figure \@ref(fig:preds-m2b): Model-based predictions for Hypothesis 2b.

This figure presents model-based predictions of subjective sexual arousal as a function of Dyadic TSD Attractive Person, across different stimulus sexes and participant genders. The three subplots correspond to the three statistical models used for analysis: (a) Cumulative Link Mixed Model (CLMM), (b) Generalized Linear Mixed Model (GLMM, Poisson), and (c) Linear Mixed Model (LMM). Shaded areas represent 95% confidence intervals.

```{r preds-m2b, cache = TRUE, message = FALSE, fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of Dyadic TSD Attractive Person, modeled using three statistical approaches: **(a)** Cumulative Link Mixed Model (CLMM); **(b)** Generalized Linear Mixed Model (GLMM) with a Poisson family; **(c)** Linear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The models include participant gender and stimulus sex as key factors."}
# CLMM Predictions
p_m2b_clmm <- emmeans(m2b_clmm, ~ Dyadic.TSD.Attractive.Person | Gender * Stimuli.sex,
  at = list(Dyadic.TSD.Attractive.Person = seq(0, 31, length.out = 100)),
  mode = "mean.class"
) |> # Compute predicted mean response categories
  as.data.frame() |> # Convert to dataframe for ggplot
  ggplot(aes(
    x = Dyadic.TSD.Attractive.Person, y = mean.class,
    color = Stimuli.sex, fill = Stimuli.sex
  )) +
  geom_line(size = 1) + # Add predicted response line
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Stimuli.sex),
    alpha = 0.2, color = NA
  ) + # Add confidence interval as shaded ribbon
  scale_color_manual(values = color.StimuliSex) + # Apply custom colors
  scale_fill_manual(values = color.StimuliSex) +
  facet_wrap(~Gender, ncol = 1) + # Create separate plots for each gender
  labs(
    y = "Predicted Subjective Sexual Arousal", 
    x = "Dyadic TSD Attractive Person",
    title = "CLMM",
    color = "Stimuli Sex", fill = "Stimuli Sex"
  ) +
  theme_tq() + # Apply custom theme
  theme(legend.position = "bottom") +
  ylim(c(0.3, 6.5)) # Set Y-axis limits

# Poisson GLMM Predictions
p_m2b_poisson <- emmeans(m2b_poisson, ~ Dyadic.TSD.Attractive.Person | Gender * Stimuli.sex,
  at = list(Dyadic.TSD.Attractive.Person = seq(0, 31, length.out = 100)),
  type = "response"
) |> # Compute response-scale predictions
  as.data.frame() |>
  ggplot(aes(
    x = Dyadic.TSD.Attractive.Person, y = rate,
    color = Stimuli.sex, fill = Stimuli.sex
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Stimuli.sex),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.StimuliSex) +
  scale_fill_manual(values = color.StimuliSex) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "ADyadic TSD Attractive Person",
    title = "GLMER (Poisson)",
    color = "Stimuli Sex", fill = "Stimuli Sex"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 6.5))

# LMM Predictions
p_m2b_lmer <- emmeans(m2b_lmer, ~ Dyadic.TSD.Attractive.Person | Gender * Stimuli.sex,
  at = list(Dyadic.TSD.Attractive.Person = seq(0, 31, length.out = 100)),
  type = "response"
) |>
  as.data.frame() |>
  ggplot(aes(
    x = Dyadic.TSD.Attractive.Person, y = emmean,
    color = Stimuli.sex, fill = Stimuli.sex
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Stimuli.sex),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.StimuliSex) +
  scale_fill_manual(values = color.StimuliSex) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Dyadic TSD Attractive Person",
    title = "LMM",
    color = "Stimuli Sex", fill = "Stimuli Sex"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 6.5))

# Arrange Plots into a Single Figure
p_robu_m2b <- ggarrange(p_m2b_clmm, p_m2b_poisson, p_m2b_lmer, # Combine plots side by side
  common.legend = TRUE, # Share legend across plots
  labels = "auto", # Automatically label subfigures (a, b, c)
  legend = "bottom",
  nrow = 1
) # Arrange in a single row

# Display the combined figure
p_robu_m2b
```

#### Final Model: Effects of Dyadic TSD Attractive Person on SSA Across Gender and Stimuli Sex

Given the aparent robustness of most results across models (CLMM, GLMER and LMM; Table \@ref(tab:tab-robu-m2b), Fig. \@ref(fig:preds-m2b)), we test the predictions of the hypothesis from the LMM (`m2b_lmer`).

##### Table \@ref(tab:tab-m2b). ANOVA-type table for the interaction between `Relationship type`, and `Gender`

This tables summarizes the results of the model.

```{r tab-m2b}
anova.sig.lmer(model = m2b_lmer, custom_caption = "Effects of Dyadic TSD Attractive Person on SSA Across 
              Gender and Stimuli Sex")
```

##### *Post-hoc* tests

To test the hypothesis, which predicted that there would be different relationship between SSA and Dyadic TSD Attractive Person, and that this association differ between men and women depending on the sex of stimuli, we used simple slope analysis.

Slope for Dyadic TSD Attractive Person on SSA by stimuli sex and participant gender

```{r cache = TRUE, warning = FALSE, message = FALSE}
slop.m2b_lmer <- sim_slopes(m2b_lmer, 
                            pred = Dyadic.TSD.Attractive.Person, 
                            modx = Stimuli.sex, 
                            mod2 = Gender,
                            confint = TRUE)

slop.m2b_lmer.tab <- bind_rows(slop.m2b_lmer$slopes[[1]] |> 
                                 mutate(Gender = "Women"),
                               slop.m2b_lmer$slopes[[2]] |> 
                                 mutate(Gender = "Men")) |>
  mutate(Gender = recode_factor(Gender,
    Femenino = "Women",
    Masculino = "Men"
  )) |> 
  select(8, 1:2, 4:7) |>
  mutate(across(3:7, as.numeric)) |>
  mutate(across(3:6, round, 2)) |>
  mutate(sig = pval.stars(p)) |>
  rename("Stimuli.sex" = "Value of Stimuli.sex") |>
  rename(Coefficient = Est.)

slop.m2b_lmer.tab[,-c(1,8)] |> 
  mutate(p = pval.lev(p)) |> 
  kable(booktabs = TRUE,
        align = c("l", rep("c", 5)),
        caption = "Slope for Dyadic TSD Attractive Person on 
        Subjective sexual arousal by stimuli sex and gender",
        linesep = "",
        col.names = c("Stimuli sex",
                      "$B$",
                      "$2.5\\% CI$",
                      "$97.5\\% CI$",
                      "$t$",
                      "$p$"),
        escape = FALSE) |> 
  kable_styling(latex_options = c("HOLD_position")) |>
  pack_rows(
      group_label = "Gender: Women",
      start_row = 1,
      end_row = 2,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  pack_rows(
      group_label =  "Gender: Men",
      start_row = 3,
      end_row = 4,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  footnote(general = "$B$ are unstandardized coefficient.
           No intercept is reported as continuous predictors were centered
           and are dependent on this specific sample.",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE,
           escape = FALSE)
```

#### Figure \@ref(fig:fig-h2b). Subjective sexual arousal to erotic stimuli: Main effects and interactions

This figure summarizes the results of hypothesis 2b. 

```{r fig-h2b, results = "hold", fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of Dyadic TSD Partner, modeled using aLinear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The model include participant gender and stimuli sex as key factors.", warning = FALSE, message = FALSE}
# Figure interaction between Stimuli sex and gender
p_m2b.fin <- p_m2b_lmer +
  labs(title = "",
       y = "Predicted Subjective Sexual Arousal") +
  facet_wrap(~ Gender, ncol = 2) +
  # Add text labels, nudging each one slightly down
  geom_text(data = slop.m2b_lmer.tab |> 
              mutate(Dyadic.TSD.Attractive.Person = 2),
            mapping = aes(x = min(Dyadic.TSD.Attractive.Person), y = Inf, 
                          label = paste("B = ", Coefficient, 
                                        ", IC 95%[", `2.5%`, ", ", `97.5%`, 
                                        "], p", 
                                        ifelse(grepl("<", pe2.lev(p)), pe2.lev(p), 
                                               paste0(" = ", pe2.lev(p))),
                                        ifelse(is.na(sig), "", sig)),
                          vjust = 2 + as.numeric(as.factor(Stimuli.sex))*2),  # Stacks labels
            hjust = -0.1,  # Aligns to the left
            #size = 3,
            show.legend = FALSE) +
  theme(legend.position = "bottom")
p_m2b.fin
```

### Hypothesis 2c: Dyadic TSD Partner {#hyp2c}

#### Model Robustness: Examining the Effects of Dyadic TSD Partner on SSA Across Gender and Stimuli Sex

To assess the robustness of our findings, we fitted three different models examining how Dyadic TSD Partner predicts SSA, considering variations by gender and stimuli sex:

1. Cumulative Link Mixed Model (CLMM) – `m2c_clmm` (for ordinal outcomes, using a probit link).
2. Generalized Linear Mixed Model (GLMM) with Poisson family – `m2c_poisson` (treating SSA as a count variable).
3. Linear Mixed Model (LMM) – `m2c_lmer` (treating SSA as a continuous variable).

```{r cache = TRUE, message = FALSE, warning = FALSE}
# Cumulative Link Mixed Model (CLMM) - Ordinal model with probit link
m2c_clmm <- clmm(
  Subjective.sexual.arousal.factor ~ Dyadic.TSD.Partner * Gender * Stimuli.sex +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 + Stimuli.sex | Participant), # Random intercept & slope for Stimuli sex
  data = dat_m2,
  link = "probit",
  control = list(method = "nlminb") # Use 'nlminb' optimizer for better convergence
)

# Generalized Linear Mixed Model (GLMM) - Poisson regression for count data
m2c_poisson <- glmer(
  Subjective.sexual.arousal ~ Dyadic.TSD.Partner * Gender * Stimuli.sex +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 + Stimuli.sex | Participant), # Random intercept & slope for Stimuli sex
  data = dat_m2,
  family = poisson # Poisson distribution for count data
)

# Linear Mixed Model (LMM) - Continuous approximation
m2c_lmer <- lmer(
  Subjective.sexual.arousal ~ Dyadic.TSD.Partner * Gender * Stimuli.sex +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 + Stimuli.sex | Participant), # Random intercept & slope for Stimuli sex
  data = dat_m2,
  control = lmerControl(optimizer = "bobyqa") # Use 'bobyqa' optimizer for stability
)
```

##### Table \@ref(tab:tab-robu-m2c). ANOVA-type table of fixed effects (main effects and interactions) across the three fitted models

As shown in the table below, the pattern of significant effects remains consistent across all three models, except for the main effect of gender, which is not significant in the CLMM.

```{r tab-robu-m2c, message = FALSE}
anova.comp(CLMMmod = m2c_clmm, GLMERmod = m2c_poisson, LMERmod = m2c_lmer, hypothesis = "2c")
```

##### Figure \@ref(fig:preds-m2c): Model-based predictions for Hypothesis 2c.

This figure presents model-based predictions of subjective sexual arousal as a function of Dyadic TSD Partner, across different stimulus sexes and participant genders. The three subplots correspond to the three statistical models used for analysis: (a) Cumulative Link Mixed Model (CLMM), (b) Generalized Linear Mixed Model (GLMM, Poisson), and (c) Linear Mixed Model (LMM). Shaded areas represent 95% confidence intervals.

```{r preds-m2c, cache = TRUE, message = FALSE, fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of Dyadic TSD Partner, modeled using three statistical approaches: **(a)** Cumulative Link Mixed Model (CLMM); **(b)** Generalized Linear Mixed Model (GLMM) with a Poisson family; **(c)** Linear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The models include participant gender and stimulus sex as key factors."}
# CLMM Predictions
p_m2c_clmm <- emmeans(m2c_clmm, ~ Dyadic.TSD.Partner | Gender * Stimuli.sex,
  at = list(Dyadic.TSD.Partner = seq(0, 31, length.out = 100)),
  mode = "mean.class"
) |> # Compute predicted mean response categories
  as.data.frame() |> # Convert to dataframe for ggplot
  ggplot(aes(
    x = Dyadic.TSD.Partner, y = mean.class,
    color = Stimuli.sex, fill = Stimuli.sex
  )) +
  geom_line(size = 1) + # Add predicted response line
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Stimuli.sex),
    alpha = 0.2, color = NA
  ) + # Add confidence interval as shaded ribbon
  scale_color_manual(values = color.StimuliSex) + # Apply custom colors
  scale_fill_manual(values = color.StimuliSex) +
  facet_wrap(~Gender, ncol = 1) + # Create separate plots for each gender
  labs(
    y = "Predicted Subjective Sexual Arousal", 
    x = "Dyadic TSD Partner",
    title = "CLMM",
    color = "Stimuli Sex", fill = "Stimuli Sex"
  ) +
  theme_tq() + # Apply custom theme
  theme(legend.position = "bottom") +
  ylim(c(0.3, 5.3)) # Set Y-axis limits

# Poisson GLMM Predictions
p_m2c_poisson <- emmeans(m2c_poisson, ~ Dyadic.TSD.Partner | Gender * Stimuli.sex,
  at = list(Dyadic.TSD.Partner = seq(0, 31, length.out = 100)),
  type = "response"
) |> # Compute response-scale predictions
  as.data.frame() |>
  ggplot(aes(
    x = Dyadic.TSD.Partner, y = rate,
    color = Stimuli.sex, fill = Stimuli.sex
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Stimuli.sex),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.StimuliSex) +
  scale_fill_manual(values = color.StimuliSex) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Dyadic TSD Partner",
    title = "GLMER (Poisson)",
    color = "Stimuli Sex", fill = "Stimuli Sex"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 5.3))

# LMM Predictions
p_m2c_lmer <- emmeans(m2c_lmer, ~ Dyadic.TSD.Partner | Gender * Stimuli.sex,
  at = list(Dyadic.TSD.Partner = seq(0, 31, length.out = 100)),
  type = "response"
) |>
  as.data.frame() |>
  ggplot(aes(
    x = Dyadic.TSD.Partner, y = emmean,
    color = Stimuli.sex, fill = Stimuli.sex
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Stimuli.sex),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.StimuliSex) +
  scale_fill_manual(values = color.StimuliSex) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Dyadic TSD Partner",
    title = "LMM",
    color = "Stimuli Sex", fill = "Stimuli Sex"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 5.3))

# Arrange Plots into a Single Figure
p_robu_m2c <- ggarrange(p_m2c_clmm, p_m2c_poisson, p_m2c_lmer, # Combine plots side by side
  common.legend = TRUE, # Share legend across plots
  labels = "auto", # Automatically label subfigures (a, b, c)
  legend = "bottom",
  nrow = 1
) # Arrange in a single row

# Display the combined figure
p_robu_m2c
```

#### Final Model: Effects of Dyadic TSD Partner on SSA Across Gender and Stimuli Sex

Given the aparent robustness of most results across models (CLMM, GLMER and LMM; Table \@ref(tab:tab-robu-m2c), Fig. \@ref(fig:preds-m2c)), we test the predictions of the hypothesis from the LMM (`m2c_lmer`).

##### Table \@ref(tab:tab-m2c). ANOVA-type table for the interaction between `Relationship type`, and `Gender`

This tables summarizes the results of the model.

```{r tab-m2c}
anova.sig.lmer(model = m2c_lmer, custom_caption = "Effects of Dyadic TSD Partner on SSA Across 
              Gender and Stimuli Sex")
```

##### *Post-hoc* tests

To test the hypothesis, which predicted that there would be different relationship between SSA and Dyadic TSD Partner, and that this association differ between men and women depending on the sex of stimuli, we used simple slope analysis.

Slope for Dyadic TSD Partner on SSA by stimuli sex and participant gender

```{r cache = TRUE, warning = FALSE, message = FALSE}
slop.m2c_lmer <- sim_slopes(m2c_lmer, 
                            pred = Dyadic.TSD.Partner, 
                            modx = Stimuli.sex, 
                            mod2 = Gender,
                            confint = TRUE)

slop.m2c_lmer.tab <- bind_rows(slop.m2c_lmer$slopes[[1]] |> 
                                 mutate(Gender = "Women"),
                               slop.m2c_lmer$slopes[[2]] |> 
                                 mutate(Gender = "Men")) |>
  mutate(Gender = recode_factor(Gender,
    Femenino = "Women",
    Masculino = "Men"
  )) |> 
  select(8, 1:2, 4:7) |>
  mutate(across(3:7, as.numeric)) |>
  mutate(across(3:6, round, 2)) |>
  mutate(sig = pval.stars(p)) |>
  rename("Stimuli.sex" = "Value of Stimuli.sex") |>
  rename(Coefficient = Est.)

slop.m2c_lmer.tab[,-c(1,8)] |> 
  mutate(p = pval.lev(p)) |> 
  kable(booktabs = TRUE,
        align = c("l", rep("c", 5)),
        caption = "Slope for Dyadic TSD Partner on 
        Subjective sexual arousal by stimuli sex and gender",
        linesep = "",
        col.names = c("Stimuli sex",
                      "$B$",
                      "$2.5\\% CI$",
                      "$97.5\\% CI$",
                      "$t$",
                      "$p$"),
        escape = FALSE) |> 
  kable_styling(latex_options = c("HOLD_position")) |>
  pack_rows(
      group_label = "Gender: Women",
      start_row = 1,
      end_row = 2,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  pack_rows(
      group_label =  "Gender: Men",
      start_row = 3,
      end_row = 4,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  footnote(general = "$B$ are unstandardized coefficient.
           No intercept is reported as continuous predictors were centered
           and are dependent on this specific sample.",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE,
           escape = FALSE)
```

#### Figure \@ref(fig:fig-h2c). Subjective sexual arousal to erotic stimuli: Main effects and interactions

This figure summarizes the results of hypothesis 2c. 

```{r fig-h2c, results = "hold", fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of Dyadic TSD Partner, modeled using aLinear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The model include participant gender and stimuli sex as key factors.", warning = FALSE, message = FALSE}
# Figure interaction between Stimuli sex and gender
p_m2c.fin <- p_m2c_lmer +
  labs(title = "",
       y = "Predicted Subjective Sexual Arousal") +
  facet_wrap(~ Gender, ncol = 2) +
  # Add text labels, nudging each one slightly down
  geom_text(data = slop.m2c_lmer.tab |> 
              mutate(Dyadic.TSD.Partner = 2),
            mapping = aes(x = min(Dyadic.TSD.Partner), y = Inf, 
                          label = paste("B = ", Coefficient, 
                                        ", IC 95%[", `2.5%`, ", ", `97.5%`, 
                                        "], p", 
                                        ifelse(grepl("<", pe2.lev(p)), pe2.lev(p), 
                                               paste0(" = ", pe2.lev(p))),
                                        ifelse(is.na(sig), "", sig)),
                          vjust = 2 + as.numeric(as.factor(Stimuli.sex))*2),  # Stacks labels
            hjust = -0.1,  # Aligns to the left
            #size = 3,
            show.legend = FALSE) +
  theme(legend.position = "bottom")
p_m2c.fin
```

## Hypothesis 3: The associations between TSD dimensions and SSA toward stimuli of self-reported preferred gender will be moderated by gender and relationship status. {#hyp3}

We tested whether the relationship between SSA and TSD varies across the three dimensions of TSD and whether these associations differ between men and women depending on whether they were single or not, but only in responses toward stimuli of the preferred sex. This is a fully exploratory hypothesis, for which no directional predictions were made, beyond an interaction between the TSD dimension, gender, and relationship status. As with the case of Hypothesys 2 (section \@ref(hyp2)), fitted separate models for each TSD dimension:

* **H3a**: Solitary TSD and SSA
* **H3b**: Dyadic TSD toward an attractive person
* **H3c**: Dyadic TSD toward a partner

To examine this hypothesis, we modeled the effects of each of the three TSD dimension scores, gender, relationship status, and their interactions, on SSA towars stimuli of the self-reported preferred sex. We included random intercepts for each stimulus, as well as random intercepts for each participant. 

### Modeling Approach

Following the strategy employed for Hypothesys 2 (section \@ref(hyp2)), and given that SSA is an ordinal variable with seven ordered levels, we fitted diferent models using three different approaches to ensure the robustness of our results:

1. Cumulative Link Mixed Model (CLMM), using the `clmm` function from the package `ordinal` [@ordinalcit]
2. Generalized Mixed Model (GLMM) with a Poisson family, using the `glmer` function from the package `lme4` [@lme4cit]
3. Linear mixed model (LMM), using the `lmer` function from the package `lmerTest` [@lmertestcit]

The results across these models were largely consistent, indicating robustness in our findings. For clarity and interpretability, we primarily base our inferences on the LMM, as it provides the most straightforward interpretation and has a wider range of available functions in R for extracting model information.

### Data

We created a new dataset by selecting, once again, only responses to erotic stimuli but this time also filtering only responses to stimuli of the peferred sex. We also renamed key variables to remove spaces for compatibility with certain functions, and created a factor version of Subjective sexual arousal for use in the CLMM model. 

```{r message = FALSE, warning = FALSE}
# Filter dataset to include only responses to erotic stimuli
dat_m3 <- dat |>
  filter(`Stimuli content` == "Erotic" &
           `Stimuli sex` == `Preferred sex`)|> 
  rename(Subjective.sexual.arousal = `Subjective sexual arousal`,
          Solitary.TSD = `Solitary sexual desire`,
         Dyadic.TSD.Attractive.Person = `Dyadic sexual desire (Attractive person)`,
         Dyadic.TSD.Partner = `Dyadic sexual desire (Partner)`,
         Stimuli.code = `Stimuli code`) |> 
  mutate(Subjective.sexual.arousal.factor = as.factor(Subjective.sexual.arousal))
```

### Hypothesis 3a: Solitary TSD {#hyp3a}

#### Model Robustness: Examining the Effects of Solitary TSD on SSA Across Gender and Stimuli Sex

To assess the robustness of our findings, we fitted three different models examining how Solitary TSD predicts SSA, considering variations by gender and stimuli sex:

1. Cumulative Link Mixed Model (CLMM) – `m3a_clmm` (for ordinal outcomes, using a probit link).
2. Generalized Linear Mixed Model (GLMM) with Poisson family – `m3a_poisson` (treating SSA as a count variable).
3. Linear Mixed Model (LMM) – `m3a_lmer` (treating SSA as a continuous variable).

```{r cache = TRUE, message = FALSE, warning = FALSE}
# Cumulative Link Mixed Model (CLMM) - Ordinal model with probit link
m3a_clmm <- clmm(
  Subjective.sexual.arousal.factor ~  Solitary.TSD * Gender * Relationship +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 | Participant), # Random intercept & slope for Relationship status
  data = dat_m3,
  link = "probit",
  control = list(method = "nlminb") # Use 'nlminb' optimizer for better convergence
)

# Generalized Linear Mixed Model (GLMM) - Poisson regression for count data
m3a_poisson <- glmer(
  Subjective.sexual.arousal ~  Solitary.TSD * Gender * Relationship +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 | Participant), # Random intercept & slope for Relationship status
  data = dat_m3,
  family = poisson # Poisson distribution for count data
)

# Linear Mixed Model (LMM) - Continuous approximation
m3a_lmer <- lmer(
  Subjective.sexual.arousal ~  Solitary.TSD * Gender * Relationship +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 | Participant), # Random intercept & slope for Relationship status
  data = dat_m3,
  control = lmerControl(optimizer = "bobyqa") # Use 'bobyqa' optimizer for stability
)
```

##### Table \@ref(tab:tab-robu-m3a). ANOVA-type table of fixed effects (main effects and interactions) across the three fitted models

As shown in the table below, the pattern of significant effects remains consistent across all three models, except for the main effect of gender, which is not significant in the CLMM.

```{r tab-robu-m3a, message = FALSE}
anova.comp(CLMMmod = m3a_clmm, GLMERmod = m3a_poisson, LMERmod = m3a_lmer, hypothesis = "3a")
```

##### Figure \@ref(fig:preds-m3a): Model-based predictions for Hypothesis 3a.

This figure presents model-based predictions of subjective sexual arousal as a function of  Solitary TSD, across different relationship status and participant genders. The three subplots correspond to the three statistical models used for analysis: (a) Cumulative Link Mixed Model (CLMM), (b) Generalized Linear Mixed Model (GLMM, Poisson), and (c) Linear Mixed Model (LMM). Shaded areas represent 95% confidence intervals.

```{r preds-m3a, cache = TRUE, message = FALSE, fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of  Solitary TSD, modeled using three statistical approaches: **(a)** Cumulative Link Mixed Model (CLMM); **(b)** Generalized Linear Mixed Model (GLMM) with a Poisson family; **(c)** Linear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The models include participant gender and relationship status as key factors."}
# CLMM Predictions
p_m3a_clmm <- emmeans(m3a_clmm, ~  Solitary.TSD | Gender * Relationship,
  at = list( Solitary.TSD = seq(0, 31, length.out = 100)),
  mode = "mean.class"
) |> # Compute predicted mean response categories
  as.data.frame() |> # Convert to dataframe for ggplot
  ggplot(aes(
    x =  Solitary.TSD, y = mean.class,
    color = Relationship, fill = Relationship
  )) +
  geom_line(size = 1) + # Add predicted response line
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Relationship),
    alpha = 0.2, color = NA
  ) + # Add confidence interval as shaded ribbon
  scale_color_manual(values = color.Relationship) + # Apply custom colors
  scale_fill_manual(values = color.Relationship) +
  facet_wrap(~Gender, ncol = 1) + # Create separate plots for each gender
  labs(
    y = "Predicted Subjective Sexual Arousal", x = "Solitary Sexual Desire",
    title = "CLMM"
  ) +
  theme_tq() + # Apply custom theme
  theme(legend.position = "bottom") +
  ylim(c(0.3, 6)) # Set Y-axis limits

# Poisson GLMM Predictions
p_m3a_poisson <- emmeans(m3a_poisson, ~  Solitary.TSD | Gender * Relationship,
  at = list( Solitary.TSD = seq(0, 31, length.out = 100)),
  type = "response"
) |> # Compute response-scale predictions
  as.data.frame() |>
  ggplot(aes(
    x =  Solitary.TSD, y = rate,
    color = Relationship, fill = Relationship
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Relationship),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.Relationship) +
  scale_fill_manual(values = color.Relationship) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Solitary Sexual Desire",
    title = "GLMER (Poisson)"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 6))

# LMM Predictions
p_m3a_lmer <- emmeans(m3a_lmer, ~  Solitary.TSD | Gender * Relationship,
  at = list( Solitary.TSD = seq(0, 31, length.out = 100)),
  type = "response"
) |>
  as.data.frame() |>
  ggplot(aes(
    x =  Solitary.TSD, y = emmean,
    color = Relationship, fill = Relationship
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Relationship),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.Relationship) +
  scale_fill_manual(values = color.Relationship) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Solitary Sexual Desire",
    title = "LMM"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 6))

# Arrange Plots into a Single Figure
p_robu_m3a <- ggarrange(p_m3a_clmm, p_m3a_poisson, p_m3a_lmer, # Combine plots side by side
  common.legend = TRUE, # Share legend across plots
  labels = "auto", # Automatically label subfigures (a, b, c)
  legend = "bottom",
  nrow = 1
) # Arrange in a single row

# Display the combined figure
p_robu_m3a
```

#### Final Model: Effects of Solitary TSD on SSA Across Gender and Stimuli Sex

Given the aparent robustness of most results across models (CLMM, GLMER and LMM; Table \@ref(tab:tab-robu-m3a), Fig. \@ref(fig:preds-m3a)), we test the predictions of the hypothesis from the LMM (`m3a_lmer`).

##### Table \@ref(tab:tab-m3a). ANOVA-type table for the interaction between `Relationship type`, and `Gender`

This tables summarizes the results of the model.

```{r tab-m3a}
anova.sig.lmer(model = m3a_lmer, custom_caption = "Effects of Solitary TSD on SSA Across 
              Gender and Stimuli Sex")
```

##### *Post-hoc* tests

To test the hypothesis, which predicted that there would be different relationship between SSA and solitary TSD, and that this association differ between men and women depending on the sex of stimuli, we used simple slope analysis.

Slope for solitary TSD on SSA by stimuli sex and participant gender

```{r cache = TRUE, warning = FALSE, message = FALSE}
slop.m3a_lmer <- sim_slopes(m3a_lmer, 
                            pred =  Solitary.TSD, 
                            modx = Relationship, 
                            mod2 = Gender,
                            confint = TRUE)

slop.m3a_lmer.tab <- bind_rows(slop.m3a_lmer$slopes[[1]] |> 
                                 mutate(Gender = "Women"),
                               slop.m3a_lmer$slopes[[2]] |> 
                                 mutate(Gender = "Men")) |>
  mutate(Gender = recode_factor(Gender,
    Femenino = "Women",
    Masculino = "Men"
  )) |> 
  select(8, 1:2, 4:7) |>
  mutate(across(3:7, as.numeric)) |>
  mutate(across(3:6, round, 2)) |>
  mutate(sig = pval.stars(p)) |>
  rename("Relationship" = "Value of Relationship") |>
  rename(Coefficient = Est.)

slop.m3a_lmer.tab[,-c(1,8)] |> 
  mutate(p = pval.lev(p)) |> 
  kable(booktabs = TRUE,
        align = c("l", rep("c", 5)),
        caption = "Slope for Solitary TSD on 
        Subjective sexual arousal by stimuli sex and gender",
        linesep = "",
        col.names = c("Relationship status",
                      "$B$",
                      "$2.5\\% CI$",
                      "$97.5\\% CI$",
                      "$t$",
                      "$p$"),
        escape = FALSE) |> 
  kable_styling(latex_options = c("HOLD_position")) |>
  pack_rows(
      group_label = "Gender: Women",
      start_row = 1,
      end_row = 2,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  pack_rows(
      group_label =  "Gender: Men",
      start_row = 3,
      end_row = 4,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  footnote(general = "$B$ are unstandardized coefficient.
           No intercept is reported as continuous predictors were centered
           and are dependent on this specific sample.",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE,
           escape = FALSE)
```

#### Figure \@ref(fig:fig-h3a). Subjective sexual arousal to erotic stimuli: Main effects and interactions

This figure summarizes the results of hypothesis 3a. 

```{r fig-h3a, results = "hold", fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of Solitary TSD, modeled using aLinear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The model include participant gender and relationship status as key factors.", warning = FALSE, message = FALSE}
# Figure interaction between Relationship status and gender
p_m3a.fin <- p_m3a_lmer +
  labs(title = "",
       y = "Predicted Subjective Sexual Arousal") +
  facet_wrap(~ Gender, ncol = 2) +
  # Add text labels, nudging each one slightly down
  geom_text(data = slop.m3a_lmer.tab |> 
              mutate( Solitary.TSD = 2),
            mapping = aes(x = min( Solitary.TSD), y = Inf, 
                          label = paste("B = ", Coefficient, 
                                        ", IC 95%[", `2.5%`, ", ", `97.5%`, 
                                        "], p", 
                                        ifelse(grepl("<", pe2.lev(p)), pe2.lev(p), 
                                               paste0(" = ", pe2.lev(p))),
                                        ifelse(is.na(sig), "", sig)),
                          vjust = 2 + as.numeric(as.factor(Relationship))*2),  # Stacks labels
            hjust = -0.1,  # Aligns to the left
            #size = 3,
            show.legend = FALSE) +
  theme(legend.position = "bottom")
p_m3a.fin
```

### Hypothesis 3b: Dyadic TSD Attractive Person {#hyp3b}

#### Model Robustness: Examining the Effects of Dyadic TSD Attractive Person on SSA Across Gender and Stimuli Sex

To assess the robustness of our findings, we fitted three different models examining how Dyadic TSD Attractive Person predicts SSA, considering variations by gender and stimuli sex:

1. Cumulative Link Mixed Model (CLMM) – `m3b_clmm` (for ordinal outcomes, using a probit link).
2. Generalized Linear Mixed Model (GLMM) with Poisson family – `m3b_poisson` (treating SSA as a count variable).
3. Linear Mixed Model (LMM) – `m3b_lmer` (treating SSA as a continuous variable).

```{r cache = TRUE, message = FALSE, warning = FALSE}
# Cumulative Link Mixed Model (CLMM) - Ordinal model with probit link
m3b_clmm <- clmm(
  Subjective.sexual.arousal.factor ~ Dyadic.TSD.Attractive.Person * Gender * Relationship +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 | Participant), # Random intercept & slope for Relationship status
  data = dat_m3,
  link = "probit",
  control = list(method = "nlminb") # Use 'nlminb' optimizer for better convergence
)

# Generalized Linear Mixed Model (GLMM) - Poisson regression for count data
m3b_poisson <- glmer(
  Subjective.sexual.arousal ~ Dyadic.TSD.Attractive.Person * Gender * Relationship +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 | Participant), # Random intercept & slope for Relationship status
  data = dat_m3,
  family = poisson # Poisson distribution for count data
)

# Linear Mixed Model (LMM) - Continuous approximation
m3b_lmer <- lmer(
  Subjective.sexual.arousal ~ Dyadic.TSD.Attractive.Person * Gender * Relationship +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 | Participant), # Random intercept & slope for Relationship status
  data = dat_m3,
  control = lmerControl(optimizer = "bobyqa") # Use 'bobyqa' optimizer for stability
)
```

##### Table \@ref(tab:tab-robu-m3b). ANOVA-type table of fixed effects (main effects and interactions) across the three fitted models

As shown in the table below, the pattern of significant effects remains consistent across all three models, except for the main effect of gender, which is not significant in the CLMM.

```{r tab-robu-m3b, message = FALSE}
anova.comp(CLMMmod = m3b_clmm, GLMERmod = m3b_poisson, LMERmod = m3b_lmer, hypothesis = "3b")
```

##### Figure \@ref(fig:preds-m3b): Model-based predictions for Hypothesis 3b.

This figure presents model-based predictions of subjective sexual arousal as a function of Dyadic TSD Attractive Person, across different relationship status and participant genders. The three subplots correspond to the three statistical models used for analysis: (a) Cumulative Link Mixed Model (CLMM), (b) Generalized Linear Mixed Model (GLMM, Poisson), and (c) Linear Mixed Model (LMM). Shaded areas represent 95% confidence intervals.

```{r preds-m3b, cache = TRUE, message = FALSE, fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of Dyadic TSD Attractive Person, modeled using three statistical approaches: **(a)** Cumulative Link Mixed Model (CLMM); **(b)** Generalized Linear Mixed Model (GLMM) with a Poisson family; **(c)** Linear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The models include participant gender and relationship status as key factors."}
# CLMM Predictions
p_m3b_clmm <- emmeans(m3b_clmm, ~ Dyadic.TSD.Attractive.Person | Gender * Relationship,
  at = list(Dyadic.TSD.Attractive.Person = seq(0, 31, length.out = 100)),
  mode = "mean.class"
) |> # Compute predicted mean response categories
  as.data.frame() |> # Convert to dataframe for ggplot
  ggplot(aes(
    x = Dyadic.TSD.Attractive.Person, y = mean.class,
    color = Relationship, fill = Relationship
  )) +
  geom_line(size = 1) + # Add predicted response line
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Relationship),
    alpha = 0.2, color = NA
  ) + # Add confidence interval as shaded ribbon
  scale_color_manual(values = color.Relationship) + # Apply custom colors
  scale_fill_manual(values = color.Relationship) +
  facet_wrap(~Gender, ncol = 1) + # Create separate plots for each gender
  labs(
    y = "Predicted Subjective Sexual Arousal", x = "Attractive Person Sexual Desire",
    title = "CLMM"
  ) +
  theme_tq() + # Apply custom theme
  theme(legend.position = "bottom") +
  ylim(c(0.3, 7)) # Set Y-axis limits

# Poisson GLMM Predictions
p_m3b_poisson <- emmeans(m3b_poisson, ~ Dyadic.TSD.Attractive.Person | Gender * Relationship,
  at = list(Dyadic.TSD.Attractive.Person = seq(0, 31, length.out = 100)),
  type = "response"
) |> # Compute response-scale predictions
  as.data.frame() |>
  ggplot(aes(
    x = Dyadic.TSD.Attractive.Person, y = rate,
    color = Relationship, fill = Relationship
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Relationship),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.Relationship) +
  scale_fill_manual(values = color.Relationship) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Attractive Person Sexual Desire",
    title = "GLMER (Poisson)"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 7))

# LMM Predictions
p_m3b_lmer <- emmeans(m3b_lmer, ~ Dyadic.TSD.Attractive.Person | Gender * Relationship,
  at = list(Dyadic.TSD.Attractive.Person = seq(0, 31, length.out = 100)),
  type = "response"
) |>
  as.data.frame() |>
  ggplot(aes(
    x = Dyadic.TSD.Attractive.Person, y = emmean,
    color = Relationship, fill = Relationship
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Relationship),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.Relationship) +
  scale_fill_manual(values = color.Relationship) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Attractive Person Sexual Desire",
    title = "LMM"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 7))

# Arrange Plots into a Single Figure
p_robu_m3b <- ggarrange(p_m3b_clmm, p_m3b_poisson, p_m3b_lmer, # Combine plots side by side
  common.legend = TRUE, # Share legend across plots
  labels = "auto", # Automatically label subfigures (a, b, c)
  legend = "bottom",
  nrow = 1
) # Arrange in a single row

# Display the combined figure
p_robu_m3b
```

#### Final Model: Effects of Dyadic TSD Attractive Person on SSA Across Gender and Stimuli Sex

Given the aparent robustness of most results across models (CLMM, GLMER and LMM; Table \@ref(tab:tab-robu-m3b), Fig. \@ref(fig:preds-m3b)), we test the predictions of the hypothesis from the LMM (`m3b_lmer`).

##### Table \@ref(tab:tab-m3b). ANOVA-type table for the interaction between `Relationship type`, and `Gender`

This tables summarizes the results of the model.

```{r tab-m3b}
anova.sig.lmer(model = m3b_lmer, custom_caption = "Effects of Dyadic TSD Attractive Person on SSA Across 
              Gender and Stimuli Sex")
```

##### *Post-hoc* tests

To test the hypothesis, which predicted that there would be different relationship between SSA and Dyadic TSD Attractive Person, and that this association differ between men and women depending on the sex of stimuli, we used simple slope analysis.

Slope for Dyadic TSD Attractive Person on SSA by stimuli sex and participant gender

```{r cache = TRUE, warning = FALSE, message = FALSE}
slop.m3b_lmer <- sim_slopes(m3b_lmer, 
                            pred = Dyadic.TSD.Attractive.Person, 
                            modx = Relationship, 
                            mod2 = Gender,
                            confint = TRUE)

slop.m3b_lmer.tab <- bind_rows(slop.m3b_lmer$slopes[[1]] |> 
                                 mutate(Gender = "Women"),
                               slop.m3b_lmer$slopes[[2]] |> 
                                 mutate(Gender = "Men")) |>
  mutate(Gender = recode_factor(Gender,
    Femenino = "Women",
    Masculino = "Men"
  )) |> 
  select(8, 1:2, 4:7) |>
  mutate(across(3:7, as.numeric)) |>
  mutate(across(3:6, round, 2)) |>
  mutate(sig = pval.stars(p)) |>
  rename("Relationship" = "Value of Relationship") |>
  rename(Coefficient = Est.)

slop.m3b_lmer.tab[,-c(1,8)] |> 
  mutate(p = pval.lev(p)) |> 
  kable(booktabs = TRUE,
        align = c("l", rep("c", 5)),
        caption = "Slope for Dyadic TSD Attractive Person on 
        Subjective sexual arousal by stimuli sex and gender",
        linesep = "",
        col.names = c("Relationship status",
                      "$B$",
                      "$2.5\\% CI$",
                      "$97.5\\% CI$",
                      "$t$",
                      "$p$"),
        escape = FALSE) |> 
  kable_styling(latex_options = c("HOLD_position")) |>
  pack_rows(
      group_label = "Gender: Women",
      start_row = 1,
      end_row = 2,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  pack_rows(
      group_label =  "Gender: Men",
      start_row = 3,
      end_row = 4,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  footnote(general = "$B$ are unstandardized coefficient.
           No intercept is reported as continuous predictors were centered
           and are dependent on this specific sample.",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE,
           escape = FALSE)
```

#### Figure \@ref(fig:fig-h3b). Subjective sexual arousal to erotic stimuli: Main effects and interactions

This figure summarizes the results of hypothesis 3b. 

```{r fig-h3b, results = "hold", fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of Dyadic TSD Partner, modeled using aLinear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The model include participant gender and relationship status as key factors.", warning = FALSE, message = FALSE}
# Figure interaction between Relationship status and gender
p_m3b.fin <- p_m3b_lmer +
  labs(title = "",
       y = "Predicted Subjective Sexual Arousal") +
  facet_wrap(~ Gender, ncol = 2) +
  # Add text labels, nudging each one slightly down
  geom_text(data = slop.m3b_lmer.tab |> 
              mutate(Dyadic.TSD.Attractive.Person = 2),
            mapping = aes(x = min(Dyadic.TSD.Attractive.Person), y = Inf, 
                          label = paste("B = ", Coefficient, 
                                        ", IC 95%[", `2.5%`, ", ", `97.5%`, 
                                        "], p", 
                                        ifelse(grepl("<", pe2.lev(p)), pe2.lev(p), 
                                               paste0(" = ", pe2.lev(p))),
                                        ifelse(is.na(sig), "", sig)),
                          vjust = 2 + as.numeric(as.factor(Relationship))*2),  # Stacks labels
            hjust = -0.1,  # Aligns to the left
            #size = 3,
            show.legend = FALSE) +
  theme(legend.position = "bottom")
p_m3b.fin
```

### Hypothesis 3c: Dyadic TSD Partner {#hyp3c}

#### Model Robustness: Examining the Effects of Dyadic TSD Partner on SSA Across Gender and Stimuli Sex

To assess the robustness of our findings, we fitted three different models examining how Dyadic TSD Partner predicts SSA, considering variations by gender and stimuli sex:

1. Cumulative Link Mixed Model (CLMM) – `m3c_clmm` (for ordinal outcomes, using a probit link).
2. Generalized Linear Mixed Model (GLMM) with Poisson family – `m3c_poisson` (treating SSA as a count variable).
3. Linear Mixed Model (LMM) – `m3c_lmer` (treating SSA as a continuous variable).

```{r cache = TRUE, message = FALSE, warning = FALSE}
# Cumulative Link Mixed Model (CLMM) - Ordinal model with probit link
m3c_clmm <- clmm(
  Subjective.sexual.arousal.factor ~ Dyadic.TSD.Partner * Gender * Relationship +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 | Participant), # Random intercept & slope for Relationship status
  data = dat_m3,
  link = "probit",
  control = list(method = "nlminb") # Use 'nlminb' optimizer for better convergence
)

# Generalized Linear Mixed Model (GLMM) - Poisson regression for count data
m3c_poisson <- glmer(
  Subjective.sexual.arousal ~ Dyadic.TSD.Partner * Gender * Relationship +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 | Participant), # Random intercept & slope for Relationship status
  data = dat_m3,
  family = poisson # Poisson distribution for count data
)

# Linear Mixed Model (LMM) - Continuous approximation
m3c_lmer <- lmer(
  Subjective.sexual.arousal ~ Dyadic.TSD.Partner * Gender * Relationship +
    (1 | Stimuli.code) + # Random intercept for Stimuli
    (1 | Participant), # Random intercept & slope for Relationship status
  data = dat_m3,
  control = lmerControl(optimizer = "bobyqa") # Use 'bobyqa' optimizer for stability
)
```

##### Table \@ref(tab:tab-robu-m3c). ANOVA-type table of fixed effects (main effects and interactions) across the three fitted models

As shown in the table below, the pattern of significant effects remains consistent across all three models, except for the main effect of gender, which is not significant in the CLMM.

```{r tab-robu-m3c, message = FALSE}
anova.comp(CLMMmod = m3c_clmm, GLMERmod = m3c_poisson, LMERmod = m3c_lmer, hypothesis = "3c")
```

##### Figure \@ref(fig:preds-m3c): Model-based predictions for Hypothesis 3c.

This figure presents model-based predictions of subjective sexual arousal as a function of Dyadic TSD Partner, across different relationship status and participant genders. The three subplots correspond to the three statistical models used for analysis: (a) Cumulative Link Mixed Model (CLMM), (b) Generalized Linear Mixed Model (GLMM, Poisson), and (c) Linear Mixed Model (LMM). Shaded areas represent 95% confidence intervals.

```{r preds-m3c, cache = TRUE, message = FALSE, fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of Dyadic TSD Partner, modeled using three statistical approaches: **(a)** Cumulative Link Mixed Model (CLMM); **(b)** Generalized Linear Mixed Model (GLMM) with a Poisson family; **(c)** Linear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The models include participant gender and relationship status as key factors."}
# CLMM Predictions
p_m3c_clmm <- emmeans(m3c_clmm, ~ Dyadic.TSD.Partner | Gender * Relationship,
  at = list(Dyadic.TSD.Partner = seq(0, 31, length.out = 100)),
  mode = "mean.class"
) |> # Compute predicted mean response categories
  as.data.frame() |> # Convert to dataframe for ggplot
  ggplot(aes(
    x = Dyadic.TSD.Partner, y = mean.class,
    color = Relationship, fill = Relationship
  )) +
  geom_line(size = 1) + # Add predicted response line
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Relationship),
    alpha = 0.2, color = NA
  ) + # Add confidence interval as shaded ribbon
  scale_color_manual(values = color.Relationship) + # Apply custom colors
  scale_fill_manual(values = color.Relationship) +
  facet_wrap(~Gender, ncol = 1) + # Create separate plots for each gender
  labs(
    y = "Predicted Subjective Sexual Arousal", x = "Dyadic TSD Partner",
    title = "CLMM"
  ) +
  theme_tq() + # Apply custom theme
  theme(legend.position = "bottom") +
  ylim(c(0.3, 8)) # Set Y-axis limits

# Poisson GLMM Predictions
p_m3c_poisson <- emmeans(m3c_poisson, ~ Dyadic.TSD.Partner | Gender * Relationship,
  at = list(Dyadic.TSD.Partner = seq(0, 31, length.out = 100)),
  type = "response"
) |> # Compute response-scale predictions
  as.data.frame() |>
  ggplot(aes(
    x = Dyadic.TSD.Partner, y = rate,
    color = Relationship, fill = Relationship
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Relationship),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.Relationship) +
  scale_fill_manual(values = color.Relationship) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Dyadic TSD Partner",
    title = "GLMER (Poisson)"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 8))

# LMM Predictions
p_m3c_lmer <- emmeans(m3c_lmer, ~ Dyadic.TSD.Partner | Gender * Relationship,
  at = list(Dyadic.TSD.Partner = seq(0, 31, length.out = 100)),
  type = "response"
) |>
  as.data.frame() |>
  ggplot(aes(
    x = Dyadic.TSD.Partner, y = emmean,
    color = Relationship, fill = Relationship
  )) +
  geom_line(size = 1) +
  geom_ribbon(aes(ymin = asymp.LCL, ymax = asymp.UCL, fill = Relationship),
    alpha = 0.2, color = NA
  ) +
  scale_color_manual(values = color.Relationship) +
  scale_fill_manual(values = color.Relationship) +
  facet_wrap(~Gender, ncol = 1) +
  labs(
    y = "", x = "Dyadic TSD Partner",
    title = "LMM"
  ) +
  theme_tq() +
  theme(legend.position = "bottom") +
  ylim(c(0.3, 8))

# Arrange Plots into a Single Figure
p_robu_m3c <- ggarrange(p_m3c_clmm, p_m3c_poisson, p_m3c_lmer, # Combine plots side by side
  common.legend = TRUE, # Share legend across plots
  labels = "auto", # Automatically label subfigures (a, b, c)
  legend = "bottom",
  nrow = 1
) # Arrange in a single row

# Display the combined figure
p_robu_m3c
```

#### Final Model: Effects of Dyadic TSD Partner on SSA Across Gender and Stimuli Sex

Given the aparent robustness of most results across models (CLMM, GLMER and LMM; Table \@ref(tab:tab-robu-m3c), Fig. \@ref(fig:preds-m3c)), we test the predictions of the hypothesis from the LMM (`m3c_lmer`).

##### Table \@ref(tab:tab-m3c). ANOVA-type table for the interaction between `Relationship type`, and `Gender`

This tables summarizes the results of the model.

```{r tab-m3c}
anova.sig.lmer(model = m3c_lmer, custom_caption = "Effects of Dyadic TSD Partner on SSA Across 
              Gender and Stimuli Sex")
```

##### *Post-hoc* tests

To test the hypothesis, which predicted that there would be different relationship between SSA and Dyadic TSD Partner, and that this association differ between men and women depending on the sex of stimuli, we used simple slope analysis.

Slope for Dyadic TSD Partner on SSA by stimuli sex and participant gender

```{r cache = TRUE, warning = FALSE, message = FALSE}
slop.m3c_lmer <- sim_slopes(m3c_lmer, 
                            pred = Dyadic.TSD.Partner, 
                            modx = Relationship, 
                            mod2 = Gender,
                            confint = TRUE)

slop.m3c_lmer.tab <- bind_rows(slop.m3c_lmer$slopes[[1]] |> 
                                 mutate(Gender = "Women"),
                               slop.m3c_lmer$slopes[[2]] |> 
                                 mutate(Gender = "Men")) |>
  mutate(Gender = recode_factor(Gender,
    Femenino = "Women",
    Masculino = "Men"
  )) |> 
  select(8, 1:2, 4:7) |>
  mutate(across(3:7, as.numeric)) |>
  mutate(across(3:6, round, 2)) |>
  mutate(sig = pval.stars(p)) |>
  rename("Relationship" = "Value of Relationship") |>
  rename(Coefficient = Est.)

slop.m3c_lmer.tab[,-c(1,8)] |> 
  mutate(p = pval.lev(p)) |> 
  kable(booktabs = TRUE,
        align = c("l", rep("c", 5)),
        caption = "Slope for Dyadic TSD Partner on 
        Subjective sexual arousal by stimuli sex and gender",
        linesep = "",
        col.names = c("Relationship status",
                      "$B$",
                      "$2.5\\% CI$",
                      "$97.5\\% CI$",
                      "$t$",
                      "$p$"),
        escape = FALSE) |> 
  kable_styling(latex_options = c("HOLD_position")) |>
  pack_rows(
      group_label = "Gender: Women",
      start_row = 1,
      end_row = 2,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  pack_rows(
      group_label =  "Gender: Men",
      start_row = 3,
      end_row = 4,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  footnote(general = "$B$ are unstandardized coefficient.
           No intercept is reported as continuous predictors were centered
           and are dependent on this specific sample.",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE,
           escape = FALSE)
```

#### Figure \@ref(fig:fig-h3c). Subjective sexual arousal to erotic stimuli: Main effects and interactions

This figure summarizes the results of hypothesis 3c. 

```{r fig-h3c, results = "hold", fig.height = 6, fig.cap = "Predicted subjective sexual arousal as a function of Dyadic TSD Partner, modeled using aLinear Mixed Model (LMM). Lines represent predicted values, and shaded areas indicate 95% confidence intervals. The model include participant gender and relationship status as key factors.", warning = FALSE, message = FALSE}
# Figure interaction between Relationship status and gender
p_m3c.fin <- p_m3c_lmer +
  labs(title = "",
       y = "Predicted Subjective Sexual Arousal") +
  facet_wrap(~ Gender, ncol = 2) +
  # Add text labels, nudging each one slightly down
  geom_text(data = slop.m3c_lmer.tab |> 
              mutate(Dyadic.TSD.Partner = 2),
            mapping = aes(x = min(Dyadic.TSD.Partner), y = Inf, 
                          label = paste("B = ", Coefficient, 
                                        ", IC 95%[", `2.5%`, ", ", `97.5%`, 
                                        "], p", 
                                        ifelse(grepl("<", pe2.lev(p)), pe2.lev(p), 
                                               paste0(" = ", pe2.lev(p))),
                                        ifelse(is.na(sig), "", sig)),
                          vjust = 2 + as.numeric(as.factor(Relationship))*2),  # Stacks labels
            hjust = -0.1,  # Aligns to the left
            #size = 3,
            show.legend = FALSE) +
  theme(legend.position = "bottom")
p_m3c.fin
```

-----------------------------------------------------------------------

```{=latex}
\closesupplement
```

# Final figures and tables

Figures and tables included in the main document.

## Table \@ref(tab:tab-m1-fin). Hypothesis 1

ANOVA-type table for the interaction between `Relationship type`, and `Gender` for the three final models for hypothesis 1.

```{r tab-m1-fin}
reduce(
  list(
    bind_cols(
      anova_summary(Anova(m1a_norm, type = 3)),
      epsilon_squared(m1a_norm)
    ) |>
      unite(col = "df", DFn:DFd, sep = ", ") |>
      select(Effect, df, F, p, Epsilon2_partial) |>
      mutate(
        p = pval.lev(p),
        Epsilon2_partial = pe2.lev(Epsilon2_partial)
      ),
    bind_cols(
      anova_summary(Anova(m1b_norm, type = 3)),
      epsilon_squared(m1b_norm)
    ) |>
      unite(col = "df", DFn:DFd, sep = ", ") |>
      select(Effect, df, F, p, Epsilon2_partial) |>
      mutate(
        p = pval.lev(p),
        Epsilon2_partial = pe2.lev(Epsilon2_partial)
      ),
    bind_cols(
      anova_summary(Anova(m1b_norm, type = 3)),
      epsilon_squared(m1b_norm)
    ) |>
      unite(col = "df", DFn:DFd, sep = ", ") |>
      select(Effect, df, F, p, Epsilon2_partial) |>
      mutate(
        p = pval.lev(p),
        Epsilon2_partial = pe2.lev(Epsilon2_partial)
      )
  ),
  full_join,
  by = "Effect"
) |>
  mutate_at("Effect", str_replace_all, ":", " × ") |>
  kable(
    digits = 2,
    booktabs = TRUE,
    align = c("l", rep("c", 12)),
    linesep = "",
    caption = "Effects of relationship type and gender on TSD dimensions",
    col.names = c("Effect", rep(c("$df$", "$F$", "$p$", "$\\epsilon^2_p$"), 3)),
    escape = FALSE
  ) |>
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>
  add_header_above(c(
      " " = 1, 
      "Solitary TSD" = 4, 
      "Dyadic TSD Attractive Person" = 4, 
      "Dyadic TSD Partner" = 4
    )) |>
  footnote(
    general = paste0(
      "Sexual desire was transformed using an ordered quantile normalization
      (\\\\cite{petersonOrderedQuantileNormalization2020a}). Results are type III ANOVA.
      Solitary TSD: $R^2$ = ", round(r2(m1a_norm)$R2, 3),
      ", $R^2_{adjusted}$ = ", round(r2(m1a_norm)$R2_adjusted, 3),
      "; Dyadic TSD Attractive Person: $R^2$ = ", round(r2(m1b_norm)$R2, 3),
      ", $R^2_{adjusted}$ = ", round(r2(m1b_norm)$R2_adjusted, 3),
      "; Dyadic TSD - Partner: $R^2$ = ", round(r2(m1c_norm)$R2, 3),
      ", $R^2_{adjusted}$ = ", round(r2(m1c_norm)$R2_adjusted, 3),
      ". Gender = participants gender (women, men);
      Relationship = relationship type (stable, single).
      As effect size, we report partial epsilon squared ($\\\\epsilon^2_p$), which provides a 
      less biases estimate than $\\\\eta^2$ (see \\\\cite{albersWhenPowerAnalyses2018}).
      Significant effects are in bold."
    ),
    escape = FALSE,
    threeparttable = TRUE,
    footnote_as_chunk = TRUE
  )
```

## Figure \@ref(fig:fig-m1-fin). Hypothesis 1

Estimated marginal means for the interaction between `Relationship type`, and `Gender` for the three final models for hypothesis 1.

```{r fig-m1-fin, results = "hold", fig.height = 4.5, fig.cap = "Effects of gender and relationship type on dimensions of sexual desire. All dimensions of sexual desire were transformed using ordered quantile normalization [@petersonOrderedQuantileNormalization2020a]. **(a)**  Solitary TSD; **(b)** Dyadic TSD Attractive Person; **(c)** Dyadic TSD Partner. Dots and bars represent estimated marginal means and 95% CI. In all cases, significant effects are represented with lines and stars: \\**p* < 0.05, \\*\\**p* < 0.01, \\*\\*\\**p* < 0.001, \\*\\*\\*\\**p* < 0.0001.", warning = FALSE, message = FALSE}
ggarrange(h1a3, h1b3, h1c3,
          common.legend = TRUE,
          legend = "bottom",
          labels = "auto",
          nrow = 1)
```

## Table \@ref(tab:tab-m2-fin). Hypothesis 2

ANOVA-type table for the interaction between `Relationship type`, and `Gender` for the three final models for hypothesis 2.

```{r tab-m2-fin}
bind_rows(
  bind_cols(
    anova(m2a_lmer),
    epsilon_squared(m2a_lmer)
  ) |>
    mutate(DenDF = round(DenDF, 2)) |>
    unite(col = "df", NumDF:DenDF, sep = ", ") |>
    rownames_to_column(var = "Effect") |>
    rename(
      "F" = "F value",
      "p" = "Pr(>F)"
    ) |>
    select(Effect, df, F, p, Epsilon2_partial) |>
    mutate(
      p = pval.lev(p),
      Epsilon2_partial = pe2.lev(Epsilon2_partial)
    ),
  bind_cols(
    anova(m2b_lmer),
    epsilon_squared(m2b_lmer)
  ) |>
    mutate(DenDF = round(DenDF, 2)) |>
    unite(col = "df", NumDF:DenDF, sep = ", ") |>
    rownames_to_column(var = "Effect") |>
    rename(
      "F" = "F value",
      "p" = "Pr(>F)"
    ) |>
    select(Effect, df, F, p, Epsilon2_partial) |>
    mutate(
      p = pval.lev(p),
      Epsilon2_partial = pe2.lev(Epsilon2_partial)
    ),
  bind_cols(
    anova(m2c_lmer),
    epsilon_squared(m2c_lmer)
  ) |>
    mutate(DenDF = round(DenDF, 2)) |>
    unite(col = "df", NumDF:DenDF, sep = ", ") |>
    rownames_to_column(var = "Effect") |>
    rename(
      "F" = "F value",
      "p" = "Pr(>F)"
    ) |>
    select(Effect, df, F, p, Epsilon2_partial) |>
    mutate(
      p = pval.lev(p),
      Epsilon2_partial = pe2.lev(Epsilon2_partial)
    )
) |>
  mutate(Effect = str_replace_all(Effect, "\\.", " ")) |> # Replace dots with spaces
  mutate(Effect = str_replace_all(Effect, ":", " × ")) |> # Replace colons with ×,
  kable(
    digits = 2,
    booktabs = TRUE,
    align = c("l", rep("c", 4)),
    linesep = "",
    caption = "Effects of relationship type and gender on TSD dimensions",
    col.names = c("Effect", "$df$", "$F$", "$p$", "$\\epsilon^2_p$"),
    escape = FALSE
  ) |>
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>
  pack_rows(
      group_label =  "Solitary TSD",
      start_row = 1,
      end_row = 7,
      bold = FALSE,
      background = "lightgray"
    ) |> 
    pack_rows(
      group_label =  "Dyadic TSD Attractive Person",
      start_row = 8,
      end_row = 14,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  pack_rows(
      group_label =  "Dyadic TSD Partner",
      start_row = 15,
      end_row = 21,
      bold = FALSE,
      background = "lightgray"
    ) |>
  footnote(
    general = paste0(
      "Results are type III ANOVA.
      Solitary TSD: 
      $R^2_{conditional}$ = ", round(r2_nakagawa(m2a_lmer)$R2_conditional, 3),
      ", $R^2_{marginal}$ = ", round(r2_nakagawa(m2a_lmer)$R2_marginal, 3),
      "; Dyadic TSD Attractive Person: 
      $R^2_{conditional}$ = ", round(r2_nakagawa(m2b_lmer)$R2_conditional, 3),
      ", $R^2_{marginal}$ = ", round(r2_nakagawa(m2b_lmer)$R2_marginal, 3),
      "; Dyadic TSD - Partner: 
      $R^2_{conditional}$ = ", round(r2_nakagawa(m2c_lmer)$R2_conditional, 3),
      ", $R^2_{marginal}$ = ", round(r2_nakagawa(m2c_lmer)$R2_marginal, 3),
      ". Gender = participants gender (women, men);
      Stimuli sex = sex of stimuli (male, female).
      As effect size, we report partial epsilon squared ($\\\\epsilon^2_p$), which provides a 
      less biases estimate than $\\\\eta^2$ (see \\\\cite{albersWhenPowerAnalyses2018}).
      Significant effects are in bold."
    ),
    escape = FALSE,
    threeparttable = TRUE,
    footnote_as_chunk = TRUE
  )
```

## Figure \@ref(fig:fig-m2-fin). Hypothesis 2

Simple slopes for the interaction between dimensions of sexual desire and `Stimuli Sex`, by gender, for the three final models for hypothesis 2.

```{r fig-m2-fin, results = "hold", fig.height = 11,fig.cap = "Slopes of sexual desire dimensionson sexual arousal, by gender and stimuli sex. **(a)**  Solitary TSD; **(b)** Dyadic TSD Attractive Person; **(c)** Dyadic TSD Partner. Lines represent simple slopes and 95% CI. Significant effects are represented with stars alongside slope details: \\**p* < 0.05, \\*\\**p* < 0.01, \\*\\*\\**p* < 0.001, \\*\\*\\*\\**p* < 0.0001.", warning = FALSE, message = FALSE}
ggarrange(p_m2a.fin, p_m2b.fin, p_m2c.fin,
          common.legend = TRUE,
          legend = "bottom",
          labels = "auto",
          nrow = 3,
          ncol = 1)
```

## Table \@ref(tab:tab-m3-fin). Hypothesis 3

ANOVA-type table for the interaction between `Relationship type`, and `Gender` for the three final models for hypothesis 3.

```{r tab-m3-fin}
bind_rows(
  bind_cols(
    anova(m3a_lmer),
    epsilon_squared(m3a_lmer)
  ) |>
    mutate(DenDF = round(DenDF, 2)) |>
    unite(col = "df", NumDF:DenDF, sep = ", ") |>
    rownames_to_column(var = "Effect") |>
    rename(
      "F" = "F value",
      "p" = "Pr(>F)"
    ) |>
    select(Effect, df, F, p, Epsilon2_partial) |>
    mutate(
      p = pval.lev(p),
      Epsilon2_partial = pe2.lev(Epsilon2_partial)
    ),
  bind_cols(
    anova(m3b_lmer),
    epsilon_squared(m3b_lmer)
  ) |>
    mutate(DenDF = round(DenDF, 2)) |>
    unite(col = "df", NumDF:DenDF, sep = ", ") |>
    rownames_to_column(var = "Effect") |>
    rename(
      "F" = "F value",
      "p" = "Pr(>F)"
    ) |>
    select(Effect, df, F, p, Epsilon2_partial) |>
    mutate(
      p = pval.lev(p),
      Epsilon2_partial = pe2.lev(Epsilon2_partial)
    ),
  bind_cols(
    anova(m3c_lmer),
    epsilon_squared(m3c_lmer)
  ) |>
    mutate(DenDF = round(DenDF, 2)) |>
    unite(col = "df", NumDF:DenDF, sep = ", ") |>
    rownames_to_column(var = "Effect") |>
    rename(
      "F" = "F value",
      "p" = "Pr(>F)"
    ) |>
    select(Effect, df, F, p, Epsilon2_partial) |>
    mutate(
      p = pval.lev(p),
      Epsilon2_partial = pe2.lev(Epsilon2_partial)
    )
) |>
  mutate(Effect = str_replace_all(Effect, "\\.", " ")) |> # Replace dots with spaces
  mutate(Effect = str_replace_all(Effect, ":", " × ")) |> # Replace colons with ×,
  kable(
    digits = 2,
    booktabs = TRUE,
    align = c("l", rep("c", 4)),
    linesep = "",
    caption = "Effects of relationship type and gender on TSD dimensions",
    col.names = c("Effect", "$df$", "$F$", "$p$", "$\\epsilon^2_p$"),
    escape = FALSE
  ) |>
  kable_styling(latex_options = c("HOLD_position", "scale_down")) |>
  pack_rows(
      group_label =  "Solitary TSD",
      start_row = 1,
      end_row = 7,
      bold = FALSE,
      background = "lightgray"
    ) |> 
    pack_rows(
      group_label =  "Dyadic TSD Attractive Person",
      start_row = 8,
      end_row = 14,
      bold = FALSE,
      background = "lightgray"
    ) |> 
  pack_rows(
      group_label =  "Dyadic TSD Partner",
      start_row = 15,
      end_row = 21,
      bold = FALSE,
      background = "lightgray"
    ) |>
  footnote(
    general = paste0(
      "Results are type III ANOVA.
      Solitary TSD: 
      $R^2_{conditional}$ = ", round(r2_nakagawa(m3a_lmer)$R2_conditional, 3),
      ", $R^2_{marginal}$ = ", round(r2_nakagawa(m3a_lmer)$R2_marginal, 3),
      "; Dyadic TSD Attractive Person: 
      $R^2_{conditional}$ = ", round(r2_nakagawa(m3b_lmer)$R2_conditional, 3),
      ", $R^2_{marginal}$ = ", round(r2_nakagawa(m3b_lmer)$R2_marginal, 3),
      "; Dyadic TSD - Partner: 
      $R^2_{conditional}$ = ", round(r2_nakagawa(m3c_lmer)$R2_conditional, 3),
      ", $R^2_{marginal}$ = ", round(r2_nakagawa(m3c_lmer)$R2_marginal, 3),
      ". Gender = participants gender (women, men);
      Relationship = relationship type (stable, single).
      As effect size, we report partial epsilon squared ($\\\\epsilon^2_p$), which provides a 
      less biases estimate than $\\\\eta^2$ (see \\\\cite{albersWhenPowerAnalyses2018}).
      Significant effects are in bold."
    ),
    escape = FALSE,
    threeparttable = TRUE,
    footnote_as_chunk = TRUE
  )
```

## Figure \@ref(fig:fig-m3-fin). Hypothesis 3

Simple slopes for the interaction between dimensions of sexual desire and `Stimuli Sex`, by gender, for the three final models for hypothesis 3.

```{r fig-m3-fin, results = "hold", fig.height = 11,fig.cap = "Slopes of sexual desire dimensionson sexual arousal, by gender and relationship status. **(a)**  Solitary TSD; **(b)** Dyadic TSD Attractive Person; **(c)** Dyadic TSD Partner. Lines represent simple slopes and 95% CI. Significant effects are represented with stars alongside slope details: \\**p* < 0.05, \\*\\**p* < 0.01, \\*\\*\\**p* < 0.001, \\*\\*\\*\\**p* < 0.0001.", warning = FALSE, message = FALSE}
ggarrange(p_m3a.fin, p_m3b.fin, p_m3c.fin,
          common.legend = TRUE,
          legend = "bottom",
          labels = "auto",
          nrow = 3,
          ncol = 1)
```

-----------------------------------------------------------------------

# Session info (for reproducibility) {#session}

```{r results = "hold"}
library(pander)
pander(sessionInfo(), locale = FALSE)
```

------------------------------------------------------------------------

# Supplementary references {#refs}

\begin{multicols}{2}
\AtNextBibliography{\footnotesize}
\printbibliography[heading=none]
\normalsize
\end{multicols}

\def\printbibliography{}
